{"version":3,"sources":["webpack:///$_lazy_route_resource lazy namespace object","webpack:///src/app/app-routing.module.ts","webpack:///src/app/app.component.ts","webpack:///src/app/app.component.html","webpack:///src/app/app.module.ts","webpack:///src/app/credit-card-number.directive.ts","webpack:///src/app/credit-card/credit-card.component.ts","webpack:///src/app/credit-card/credit-card.component.html","webpack:///src/app/digit-only.directive.ts","webpack:///src/app/domain.ts","webpack:///src/app/lib.ts","webpack:///src/app/time.pipe.ts","webpack:///src/app/tooltip.directive.ts","webpack:///src/environments/environment.ts","webpack:///src/main.ts"],"names":["webpackEmptyAsyncContext","req","Promise","resolve","then","e","Error","code","keys","module","exports","id","routes","AppRoutingModule","forRoot","imports","AppComponent","timerSeconds","paymentForm","creditCard","creditCardComponent","creditCardSubGroup","emailReceipt","timer$","pipe","acc","x","ccGroup","controls","cardNumber","CREDIT_CARD_NUMBER","value","expMonth","EXPIRATION_MONTH","expYear","EXPIRATION_YEAR","name","NAME","cvv","CVV","get","console","log","onSubmit","changeDetection","OnPush","selector","templateUrl","styleUrls","AppModule","declarations","providers","bootstrap","CreditCardNumberDirective","elementRef","cardTypeChange","cardNumberChange","cardErrorChange","input","nativeElement","emit","UNKNOWN","evt","key","ctrlKey","metaKey","toLowerCase","match","replace","cardType","UNSUPPORTED_CARD","INVALID_LENGTH","INVALID_NUMBER","NONE","length","CreditCardComponent","placeHolder","CreditCardErrors","creditCardData","monthData","yearData","cardError","expError","cvvError","theDate","Date","currentMonth","getMonth","currentYear","getFullYear","expirationMonth","required","expirationYear","creditCardNumber","enable","type","monthValue","target","selectedMonth","validateExpDate","yearValue","selectedYear","val","isNaN","INVALID_DATE","INVALID_CCV","digits","Math","floor","log10","cvvDigits","valid","isValidCardNumber","isValidExpDate","isValidCVV","creditCardNumberInput","cvvTouched","dirty","className","creditCardNumberTouched","onCardNumberChange","onCardTypeChange","onCardErrorChange","onMonthChanged","onYearChanged","onCVVChanged","DigitOnlyDirective","el","navigationKeys","min","Infinity","max","inputElement","changes","pattern","regex","RegExp","maybeMin","Number","maybeMax","indexOf","preventDefault","newForecastValue","forecastValue","test","newValue","selectionStart","selectionEnd","oldValue","selection","substring","CreditCardTypes","CREDIT_CARD_ERRORS","CreditCardGroupComponents","creditCards","mastercard","image","visa","unknown","months","years","inEnum","enumeration","undefined","Object","n","i","getCardType","types","values","creditCardType","data","isCCLengthValid","cardTypeIdentifier","minLength","maxLength","isValidLuhn","ccNumbers","split","reverse","map","len","sum","j","digit","TimePipe","args","slice","TooltipDirective","renderer","vcr","offset","showTooltip","needed","tooltip","show","hide","create","setPosition","addClass","removeClass","window","setTimeout","removeChild","document","body","delay","createElement","child","tooltipTemplateRef","createEmbeddedView","rootNodes","createText","tooltipTitle","appendChild","placement","setStyle","hostPos","getBoundingClientRect","tooltipPos","scrollPos","pageYOffset","documentElement","scrollTop","top","left","height","width","bottom","right","environment","production","bootstrapModule","err","error"],"mappings":";;;;;;;;;;;;;;;;;AAAA,aAASA,wBAAT,CAAkCC,GAAlC,EAAuC;AACtC;AACA;AACA,aAAOC,OAAO,CAACC,OAAR,GAAkBC,IAAlB,CAAuB,YAAW;AACxC,YAAIC,CAAC,GAAG,IAAIC,KAAJ,CAAU,yBAAyBL,GAAzB,GAA+B,GAAzC,CAAR;AACAI,SAAC,CAACE,IAAF,GAAS,kBAAT;AACA,cAAMF,CAAN;AACA,OAJM,CAAP;AAKA;;AACDL,4BAAwB,CAACQ,IAAzB,GAAgC,YAAW;AAAE,aAAO,EAAP;AAAY,KAAzD;;AACAR,4BAAwB,CAACG,OAAzB,GAAmCH,wBAAnC;AACAS,UAAM,CAACC,OAAP,GAAiBV,wBAAjB;AACAA,4BAAwB,CAACW,EAAzB,GAA8B,yCAA9B;;;;;;;;;;;;;;;;ACZA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;;AAIA,QAAMC,MAAM,GAAW,EAAvB;;QAMaC,gB;;;;;YAAAA;;;;yBAAAA,gB;AAAgB,O;AAAA,gBAHlB,CAAC,6DAAaC,OAAb,CAAqBF,MAArB,CAAD,CAGkB,EAFjB,4DAEiB;;;;0HAAhBC,gB,EAAgB;AAAA;AAAA,kBAFjB,4DAEiB;AAAA,O;AAFL,K;;;;;sEAEXA,gB,EAAgB;cAJ5B,sDAI4B;eAJnB;AACRE,iBAAO,EAAE,CAAC,6DAAaD,OAAb,CAAqBF,MAArB,CAAD,CADD;AAERF,iBAAO,EAAE,CAAC,4DAAD;AAFD,S;AAImB,Q;;;;;;;;;;;;;;;;;;ACV7B;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;;QAaaM,Y;AANb;AAAA;;AAQC;AACA;AACO,aAAAC,YAAA,GAAe,GAAf;AA4CP;;;;mCAjCkB;AAEjB;AACA,eAAKC,WAAL,GAAmB,IAAI,wDAAJ,CAAc;AAChCC,sBAAU,EAAE,KAAKC,mBAAL,CAAyBC,kBADL;AAEhCC,wBAAY,EAAE,IAAI,0DAAJ,CAAgB,KAAhB;AAFkB,WAAd,CAAnB,CAHiB,CAQjB;;AACA,eAAKC,MAAL,GAAc,mDAAM,CAAN,EAAS,IAAT,EAAeC,IAAf,CACb,4DAAK,UAAAC,GAAG;AAAA,mBAAI,EAAEA,GAAN;AAAA,WAAR,EAAmB,KAAKR,YAAxB,CADa,EAEb,iEAAU,UAAAS,CAAC;AAAA,mBAAIA,CAAC,IAAI,CAAT;AAAA,WAAX,CAFa,CAAd;AAIA;;;mCAEc;AACd,cAAMC,OAAO,GAAc,KAAKT,WAAL,CAAiBU,QAAjB,CAA0BT,UAArD;AACA,cAAMU,UAAU,GAAWF,OAAO,CAACC,QAAR,CAAiB,kEAA0BE,kBAA3C,EAA+DC,KAA1F;AACA,cAAMC,QAAQ,GAAWL,OAAO,CAACC,QAAR,CAAiB,kEAA0BK,gBAA3C,EAA6DF,KAAtF;AACA,cAAMG,OAAO,GAAWP,OAAO,CAACC,QAAR,CAAiB,kEAA0BO,eAA3C,EAA4DJ,KAApF;AACA,cAAMK,IAAI,GAAWT,OAAO,CAACC,QAAR,CAAiB,kEAA0BS,IAA3C,EAAiDN,KAAtE;AACA,cAAMO,GAAG,GAAWX,OAAO,CAACC,QAAR,CAAiB,kEAA0BW,GAA3C,EAAgDR,KAApE;AACA,cAAMT,YAAY,GAAW,KAAKJ,WAAL,CAAiBsB,GAAjB,CAAqB,cAArB,EAAqCT,KAAlE;AAEAU,iBAAO,CAACC,GAAR,CAAY,gBAAZ,EAA8BN,IAA9B;AACAK,iBAAO,CAACC,GAAR,CAAY,gBAAZ,EAA8Bb,UAA9B;AACAY,iBAAO,CAACC,GAAR,CAAY,gBAAZ,EAA8BV,QAA9B;AACAS,iBAAO,CAACC,GAAR,CAAY,gBAAZ,EAA8BR,OAA9B;AACAO,iBAAO,CAACC,GAAR,CAAY,gBAAZ,EAA8BJ,GAA9B;AACAG,iBAAO,CAACC,GAAR,CAAY,gBAAZ,EAA8BpB,YAA9B;AACA;;;;;;;uBA7CWN,Y;AAAY,K;;;YAAZA,Y;AAAY,+B;AAAA;AAAA;0EAWb,sF,EAAqB,I;;;;;;;;;;;;;;ACxBjC;;AACC;;AACA;;AACC;;AACA;;AAAM;;;;;;AAA0B;;AACjC;;AAED;;AAEA;;AACC;;AAAK;;AAA6B;;AAClC;;AAAK;;AAAiC;;AACtC;;AAAK;;AAAgC;;AACtC;;AAEA;;AAAgC;AAAA,mBAAY,IAAA2B,QAAA,EAAZ;AAAsB,WAAtB;;AAE/B;;AAEC;;AAEA;;AACC;;AACC;;AACA;;AACA;;AACA;;AACD;;AACA;;AAAG;;AAAsI;;AAC1I;;AAED;;AAEA;;AAEC;;AAAO;;AAAuD;;AAA4B;;AAE1F;;AAA0E;;AAAQ;;AAEnF;;AAID;;;;AAvCQ;;AAAA;;AAWF;;AAAA;;AAsB8B;;AAAA;;;;;;;;;;;sEDxBvB3B,Y,EAAY;cANxB,uDAMwB;eANd;AACV4B,yBAAe,EAAE,sEAAwBC,MAD/B;AAEVC,kBAAQ,EAAE,UAFA;AAGVC,qBAAW,EAAE,sBAHH;AAIVC,mBAAS,EAAE,CAAC,sBAAD;AAJD,S;AAMc,Q;;gBAWvB,uD;iBAAU,sF,EAAqB;AAAE,sBAAQ;AAAV,W;;;;;;;;;;;;;;;;;;;;AExBjC;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;;QA8BaC,S;;;;;YAAAA,S;AAAS,kBAFT,2DAES;;;;yBAATA,S;AAAS,O;AAAA,iBAHV,E;AAAE,gBANJ,CACR,uEADQ,EAER,oEAFQ,EAGR,kEAHQ,EAIR,uDAAcnC,OAAd,EAJQ,CAMI;;;;0HAGDmC,S,EAAS;AAAA,uBAhBpB,2DAgBoB,EAfpB,sFAeoB,EAdpB,uFAcoB,EAbpB,oEAaoB,EAZpB,mDAYoB,EAXpB,wEAWoB;AAXF,kBAGlB,uEAHkB,EAIlB,oEAJkB,EAKlB,kEALkB,EAKC,sDALD;AAWE,O;AAND,K;;;;;sEAMRA,S,EAAS;cAlBrB,sDAkBqB;eAlBZ;AACTC,sBAAY,EAAE,CACb,2DADa,EAEb,sFAFa,EAGb,uFAHa,EAIb,oEAJa,EAKb,mDALa,EAMb,wEANa,CADL;AASTnC,iBAAO,EAAE,CACR,uEADQ,EAER,oEAFQ,EAGR,kEAHQ,EAIR,uDAAcD,OAAd,EAJQ,CATA;AAeTqC,mBAAS,EAAE,EAfF;AAgBTC,mBAAS,EAAE,CAAC,2DAAD;AAhBF,S;AAkBY,Q;;;;;;;;;;;;;;;;;;AC9BtB;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;;QAOaC,yB;AAcZ,yCACWC,UADX,EACiC;AAAA;;AAAtB,aAAAA,UAAA,GAAAA,UAAA,CAAsB,CAVjC;;AACiB,aAAAC,cAAA,GAAiB,IAAI,0DAAJ,EAAjB,CASgB,CAPjC;;AACiB,aAAAC,gBAAA,GAAmB,IAAI,0DAAJ,EAAnB,CAMgB,CAJjC;;AACiB,aAAAC,eAAA,GAAkB,IAAI,0DAAJ,EAAlB;AAKhB,aAAKC,KAAL,GAAa,KAAKJ,UAAL,CAAgBK,aAA7B;AACA;;;;mCAEiB;AACjB,eAAKJ,cAAL,CAAoBK,IAApB,CAAyB,wDAAgBC,OAAzC;AACA,S,CAED;;;;AAMA;AACA;kCAEiBC,G,EAAkB;AAClC,cAAMC,GAAG,GAAWD,GAAG,CAACC,GAAxB;;AAEA,eACC;AACA;AACCA,aAAG,KAAK,GAAR,IAAeD,GAAG,CAACE,OAAJ,KAAgB,IAAhC,IAAyC;AACxCD,aAAG,KAAK,GAAR,IAAeD,GAAG,CAACE,OAAJ,KAAgB,IADhC,IACyC;AACxCD,aAAG,KAAK,GAAR,IAAeD,GAAG,CAACE,OAAJ,KAAgB,IAFhC,IAEyC;AACxCD,aAAG,KAAK,GAAR,IAAeD,GAAG,CAACE,OAAJ,KAAgB,IAHhC,IAGyC;AACxCD,aAAG,KAAK,GAAR,IAAeD,GAAG,CAACG,OAAJ,KAAgB,IAJhC,IAIyC;AACxCF,aAAG,KAAK,GAAR,IAAeD,GAAG,CAACG,OAAJ,KAAgB,IALhC,IAKyC;AACxCF,aAAG,KAAK,GAAR,IAAeD,GAAG,CAACG,OAAJ,KAAgB,IANhC,IAMyC;AACxCF,aAAG,KAAK,GAAR,IAAeD,GAAG,CAACG,OAAJ,KAAgB,IAVjC,CAUuC;AAVvC,YAWE;AACD,qBAAO,IAAP;AACA,aAhBiC,CAkBlC;;;AACA,cAAIF,GAAG,KAAK,OAAR,IAAmBA,GAAG,KAAK,WAA3B,IAA0CA,GAAG,KAAK,YAAlD,IACAA,GAAG,KAAK,SADR,IACqBA,GAAG,KAAK,KAD7B,IACsCA,GAAG,KAAK,KAD9C,IAEAA,GAAG,KAAK,MAFR,IAEkBA,GAAG,KAAK,KAF9B,EAEqC;AACpC,mBAAO,IAAP;AACA,WAvBiC,CAyBlC;;;AACA,cAAMxD,IAAI,GAAGuD,GAAG,CAACvD,IAAJ,CAAS2D,WAAT,EAAb;;AACA,cAAI3D,IAAI,KAAK,WAAT,IAAwBA,IAAI,KAAK,QAArC,EAA+C;AAC9C,mBAAO,IAAP;AACA;;AAED,cAAMwB,KAAK,GAAqBgC,GAAG,CAACI,KAAJ,CAAU,SAAV,CAAhC;;AAEA,cAAIpC,KAAK,IAAI,IAAb,EAAmB;AAClB,mBAAO,KAAP;AACA;;AAED,iBAAO,IAAP;AACA;;;kCAGa;AACb,cAAMF,UAAU,GAAW,KAAK6B,KAAL,CAAW3B,KAAX,CAAiBqC,OAAjB,CAAyB,GAAzB,EAA8B,EAA9B,CAA3B;AAEA;;;;;AAIA,cAAMC,QAAQ,GAAoB,yDAAYxC,UAAZ,CAAlC;;AAEA,cAAIwC,QAAQ,KAAK,wDAAgBR,OAAjC,EAA0C;AACzC,iBAAKJ,eAAL,CAAqBG,IAArB,CAA0B,2DAAmBU,gBAA7C;AACA,mBAAO,KAAP;AACA,WAHD,MAGO;AACN,iBAAKf,cAAL,CAAoBK,IAApB,CAAyBS,QAAzB;AACA;;AAED,cAAI,CAAC,6DAAgBxC,UAAhB,EAA4BwC,QAA5B,CAAL,EAA4C;AAC3C,iBAAKZ,eAAL,CAAqBG,IAArB,CAA0B,2DAAmBW,cAA7C;AACA,mBAAO,KAAP;AACA;;AAED,cAAI,CAAC,yDAAY1C,UAAZ,CAAL,EAA8B;AAC7B,iBAAK4B,eAAL,CAAqBG,IAArB,CAA0B,2DAAmBY,cAA7C;AACA,mBAAO,KAAP;AACA;;AAED,eAAKf,eAAL,CAAqBG,IAArB,CAA0B,2DAAmBa,IAA7C;AACA,eAAKjB,gBAAL,CAAsBI,IAAtB,CAA2B/B,UAA3B;AAEA,iBAAO,IAAP;AACA;;;4BA/EgB;AAChB,iBAAO,KAAK6B,KAAL,CAAW3B,KAAX,CAAiB2C,MAAxB;AACA;;;;;;;uBA3BWrB,yB,EAAyB,yH;AAAA,K;;;YAAzBA,yB;AAAyB,kD;AAAA;AAAA;;mBAAzB,qB;AAAiB,W,EAAA,O,EAAA;AAAA,mBAAjB,aAAiB;AAAR,W;;;;;;;;;;;;sEAATA,yB,EAAyB;cAHrC,uDAGqC;eAH3B;AACVP,kBAAQ,EAAE;AADA,S;AAG2B,Q;;;;;;gBAMpC;;;gBAGA;;;gBAGA;;;gBAoBA,0D;iBAAa,S,EAAW,CAAC,QAAD,C;;;gBAyCxB,0D;iBAAa,O;;;;;;;;;;;;;;;;;;;;AChFf;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;;;;ACyBG;;;;;;AAAsE;;;;;;AAGrE;;AACC;;AAA0B;;AAC1B;;AACD;;;;;;AAqDA;;AACC;;AACD;;;;;;AAiBD;;AACC;;AACD;;;;;;AAkCA;;AACC;;AACD;;;;QDlIU6B,mB;AAsCZ;AAAA;;AArCgB,aAAAC,WAAA,GAAc,qBAAd,CAqChB,CAlCA;;AACO,aAAAC,gBAAA,GAAmB,0DAAnB;AACA,aAAAC,cAAA,GAAiB,mDAAjB;AACA,aAAAC,SAAA,GAAY,8CAAZ;AACA,aAAAC,QAAA,GAAW,6CAAX;AAKA,aAAAX,QAAA,GAAmB,wDAAgBR,OAAnC,CAyBP,CATA;;AACO,aAAAoB,SAAA,GAAoB,2DAAmBR,IAAvC;AACA,aAAAS,QAAA,GAAmB,2DAAmBT,IAAtC;AACA,aAAAU,QAAA,GAAmB,2DAAmBV,IAAtC;AAQN,YAAMW,OAAO,GAAS,IAAIC,IAAJ,EAAtB;AACA,aAAKC,YAAL,GAAoBF,OAAO,CAACG,QAAR,EAApB;AACA,aAAKC,WAAL,GAAmBJ,OAAO,CAACK,WAAR,EAAnB,CAJD,CAKC;AACA;;AAEA,aAAKC,eAAL,GAAuB,IAAI,0DAAJ,CAAgB,IAAhB,EAAsB,0DAAWC,QAAjC,CAAvB;AACA,aAAKC,cAAL,GAAsB,IAAI,0DAAJ,CAAgB,IAAhB,EAAsB,0DAAWD,QAAjC,CAAtB;AACA,aAAKvD,IAAL,GAAY,IAAI,0DAAJ,CAAgB,IAAhB,EAAsB,0DAAWuD,QAAjC,CAAZ;AACA,aAAKrD,GAAL,GAAW,IAAI,0DAAJ,CAAgB,IAAhB,EAAsB,0DAAWqD,QAAjC,CAAX;AAEA,aAAKtE,kBAAL,GAA0B,IAAI,wDAAJ,CAAc;AACvCwE,0BAAgB,EAAE,IAAI,0DAAJ,CAAgB,IAAhB,EAAsB,0DAAWF,QAAjC,CADqB;AAEvCD,yBAAe,EAAE,KAAKA,eAFiB;AAGvCE,wBAAc,EAAE,KAAKA,cAHkB;AAIvCxD,cAAI,EAAE,KAAKA,IAJ4B;AAKvCE,aAAG,EAAE,KAAKA;AAL6B,SAAd,CAA1B;AAOA;;;;mCAEiB,CACjB,C,CAED;;;;2CAwE0BT,U,EAAkB;AAC3C,cAAIA,UAAU,CAAC6C,MAAX,GAAoB,CAApB,IAAyB,KAAKO,SAAL,KAAmB,2DAAmBR,IAAnE,EAAyE;AACxE,iBAAKiB,eAAL,CAAqBI,MAArB;AACA,iBAAKF,cAAL,CAAoBE,MAApB;AACA,iBAAKxD,GAAL,CAASwD,MAAT;AACA,WAL0C,CAO3C;;AACA;;;yCAEuBC,I,EAAqB;AAC5C,cAAIA,IAAI,KAAK,wDAAgBlC,OAA7B,EAAsC;AACrC,iBAAKQ,QAAL,GAAgB0B,IAAhB;AACA;AACD;;;0CAEwBjC,G,EAAW;AACnC,eAAKmB,SAAL,GAAiBnB,GAAjB;AACA;;;uCAEqBA,G,EAAU;AAC/B,cAAMkC,UAAU,GAAW,CAAElC,GAAG,CAACmC,MAAJ,CAAgClE,KAA7D,CAD+B,CAG/B;AACA;AACA;AACA;;AACA,eAAKmE,aAAL,GAAqBF,UAArB;AACA,eAAKG,eAAL,CAAqBH,UAArB,EAR+B,CAS/B;AACA;AACA;AACA;;;sCAEoBlC,G,EAAU;AAC9B,cAAMsC,SAAS,GAAW,aAAOtC,GAAG,CAACmC,MAAJ,CAAgClE,KAAvC,CAA1B,CAD8B,CAG9B;AACA;AACA;AACA;;AACA,eAAKsE,YAAL,GAAoBD,SAApB;AAEA,eAAKD,eAAL,CAAqBC,SAArB,EAT8B,CAW9B;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;;;wCAEuBE,G,EAAa;AACpC,cAAIC,KAAK,CAACD,GAAD,CAAT,EAAgB;AACf,iBAAKpB,QAAL,GAAgB,2DAAmBsB,YAAnC;AACA;AACA;;AAED,cAAI,KAAKhB,WAAL,GAAmB,KAAKa,YAA5B,EAA0C;AACzC,iBAAKnB,QAAL,GAAgB,2DAAmBsB,YAAnC;AACA;AACA,WATmC,CAWpC;;;AACA,eAAKtB,QAAL,GAAgB,KAAKgB,aAAL,GAAqB,KAAKZ,YAA1B,IAA0C,KAAKE,WAAL,KAAqB,KAAKa,YAApE,GACb,2DAAmBG,YADN,GAEb,2DAAmB/B,IAFtB;AAGA;;;qCAEmBX,G,EAAU;AAC7B,cAAMxB,GAAG,GAAW,CAAEwB,GAAG,CAACmC,MAAJ,CAAgClE,KAAtD;;AAEA,cAAIwE,KAAK,CAACjE,GAAD,CAAT,EAAgB;AACf,iBAAK6C,QAAL,GAAgB,2DAAmBsB,WAAnC;AACA;AACA;;AAED,cAAMC,MAAM,GAAWpE,GAAG,KAAK,CAAR,GAAY,CAAZ,GAAgBqE,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,KAAL,CAAWvE,GAAX,CAAX,IAA8B,CAArE,CAR6B,CAU7B;;AACA,cAAI,KAAK+B,QAAL,KAAkB,wDAAgBR,OAAtC,EAA+C;AAC9C,iBAAKsB,QAAL,GAAgBuB,MAAM,KAAK,oDAAY,KAAKrC,QAAjB,EAA2ByC,SAAtC,GACb,2DAAmBrC,IADN,GAEb,2DAAmBgC,WAFtB;AAGA,WAJD,MAIO;AACN;AACA,iBAAKtB,QAAL,GAAgB,2DAAmBsB,WAAnC;AACA;AACD;;;4BAnKe;AACf,iBAAO,KAAKpF,kBAAL,CAAwB0F,KAAxB,IACH,KAAKC,iBADF,IACuB,KAAKC,cAD5B,IAC8C,KAAKC,UAD1D;AAEA,S,CAGD;;;;4BAC4B;AAC3B,iBAAO,KAAK7C,QAAL,KAAkB,wDAAgBR,OAAlC,IACH,KAAKsD,qBAAL,CAA2BzC,MAA3B,GAAoC,CADjC,IAEH,KAAKO,SAAL,KAAmB,2DAAmBR,IAF1C;AAGA,S,CAED;;;;4BACyB;AACxB;AACA,iBAAO,KAAK4B,YAAL,GAAoB,KAAKb,WAAzB,IACF,KAAKU,aAAL,IAAsB,KAAKZ,YAA3B,IACA,KAAKE,WAAL,KAAqB,KAAKa,YAF/B;AAGA,S,CAED;;;;4BACqB;AACpB,iBAAO,KAAKe,UAAL,IAAmB,KAAKjC,QAAL,KAAkB,2DAAmBV,IAA/D;AACA,S,CAGD;;;;4BACkC;AACjC,iBAAO,KAAKpD,kBAAL,CAAwBmB,GAAxB,CAA4B,kBAA5B,EAAgD6E,KAAvD;AACA,S,CAED;;;;4BACqB;AACpB,iBAAO,KAAK/E,GAAL,CAAS+E,KAAhB;AACA;;;4BAEwB;AACxB,iBAAO,KAAK3B,eAAL,CAAqB2B,KAArB,IAA8B,KAAKzB,cAAL,CAAoByB,KAAzD;AACA,S,CAGD;;;;4BACgC;AAC/B,cAAIC,SAAS,GAAG,MAAhB;;AAEA,cAAI,CAAC,KAAKC,uBAAV,EAAmC;AAClCD,qBAAS,IAAI,cAAb;AACA,WAFD,MAEO;AACNA,qBAAS,IAAI,KAAKN,iBAAL,GAAyB,WAAzB,GAAuC,YAApD;AACA;;AAED,iBAAOM,SAAP;AACA,S,CAED;;;;4BACmB;AAClB,cAAIA,SAAS,GAAG,aAAhB;;AAEA,cAAI,CAAC,KAAKF,UAAV,EAAsB;AACrB;AACAE,qBAAS,IAAI,cAAb;AACA,WAHD,MAGO;AACN;AACAA,qBAAS,IAAI,KAAKnC,QAAL,KAAkB,2DAAmBV,IAArC,GAA4C,aAA5C,GAA4D,WAAzE;AACA;;AAED,iBAAO6C,SAAP;AACA;;;;;;;uBApIW3C,mB;AAAmB,K;;;YAAnBA,mB;AAAmB,sC;AAAA;AAAA;0EAmCpB,uF,EAA2B,I;;;;;;;;;;;;;;;;;AC9CvC;;AAEC;;AAEC;;AAEC;;AAaC;AAAA,mBAAoB,IAAA6C,kBAAA,QAApB;AAA8C,WAA9C,EAA+C,gBAA/C,EAA+C;AAAA,mBAC7B,IAAAC,gBAAA,QAD6B;AACL,WAD1C,EAA+C,iBAA/C,EAA+C;AAAA,mBAE5B,IAAAC,iBAAA,QAF4B;AAEH,WAF5C;;AAbD;;AAiBA;;AAA6B;;AAAe;;AAE5C;;AAEA;;AAMD;;AAUA;;AAEC;;AACC;;AAUC;AAAA,mBAAU,IAAAC,cAAA,QAAV;AAAgC,WAAhC;;AAVD;;AAWA;;AAA6B;;AAAK;;AACnC;;AAEA;;AAAmC;;AAAC;;AAGpC;;AACC;;AAcC;AAAA,mBAAU,IAAAC,aAAA,QAAV;AAA+B,WAA/B;;AAdD;;AAeA;;AAAqC;;AAAG;;AACzC;;AAGA;;AAMD;;AAEA;;AACC;;AAQA;;AAA6B;;AAAc;;AAC5C;;AACA;;AAKD;;AAEA;;AAEC;;AAEA;;AACC;;AACC;;AACA;;AACA;;AACA;;AACD;;AAGA;;AAaC;AAAA,mBAAS,IAAAC,YAAA,QAAT;AAA6B,WAA7B;;AAbD;;AAcA;;AAA6B;;AAAO;;AACrC;;AACA;;AAMA;;AAA2B;;AAAU;;AAAK;;AAAgB;;AAE3D;;AAED;;;;;;;;;;;;AApJK;;AASD;;AAAA,8FAAoD,aAApD,EAAoD,iKAApD;;AAc4B;;AAAA;;AAEF;;AAAA;;AAyCzB;;AAAA,8FAA6C,aAA7C,EAA6C,yCAA7C;;AA4BD;;AAAA,8FAA0C,aAA1C,EAA0C,oFAA1C;;AA8BA;;AAAA,8FAAyC,aAAzC,EAAyC,iCAAzC;;;;;;;;;;sEDjHSlD,mB,EAAmB;cAN/B,uDAM+B;eANrB;AACV/B,yBAAe,EAAE,sEAAwBC,MAD/B;AAEVC,kBAAQ,EAAE,iBAFA;AAGVC,qBAAW,EAAE,8BAHH;AAIVC,mBAAS,EAAE,CAAC,8BAAD;AAJD,S;AAMqB,Q;;;;gBAC9B;;;gBAkCA,uD;iBAAU,uF,EAA2B;AAAE,sBAAQ;AAAV,W;;;;;;;;;;;;;;;;;;;;AE9CvC;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;;QAKa8E,kB;AAuBZ,kCAA2BC,EAA3B,EAA2C;AAAA;;AAAhB,aAAAA,EAAA,GAAAA,EAAA;AArBnB,aAAAC,cAAA,GAAiB,CACxB,WADwB,EAExB,QAFwB,EAGxB,KAHwB,EAIxB,QAJwB,EAKxB,OALwB,EAMxB,MANwB,EAOxB,KAPwB,EAQxB,WARwB,EASxB,YATwB,EAUxB,OAVwB,EAWxB,MAXwB,EAYxB,OAZwB,CAAjB;AAeQ,aAAAC,GAAA,GAAM,CAACC,QAAP;AACA,aAAAC,GAAA,GAAMD,QAAN;AAMf,aAAKE,YAAL,GAAoBL,EAAE,CAACpE,aAAvB;AACA;;;;oCAEkB0E,O,EAAwB;AAC1C,cAAIA,OAAO,CAACC,OAAZ,EAAqB;AACpB,iBAAKC,KAAL,GAAa,KAAKD,OAAL,GAAeE,MAAM,CAAC,KAAKF,OAAN,CAArB,GAAsC,IAAnD;AACA;;AAED,cAAID,OAAO,CAACJ,GAAZ,EAAiB;AAChB,gBAAMQ,QAAQ,GAAGC,MAAM,CAAC,KAAKT,GAAN,CAAvB;AACA,iBAAKA,GAAL,GAAW1B,KAAK,CAACkC,QAAD,CAAL,GAAkB,CAACP,QAAnB,GAA8BO,QAAzC;AACA;;AAED,cAAIJ,OAAO,CAACF,GAAZ,EAAiB;AAChB,gBAAMQ,QAAQ,GAAGD,MAAM,CAAC,KAAKP,GAAN,CAAvB;AACA,iBAAKA,GAAL,GAAW5B,KAAK,CAACoC,QAAD,CAAL,GAAkBT,QAAlB,GAA6BS,QAAxC;AACA;AACD;;;kCAIgBtI,C,EAAkB;AAElC,cACC,KAAK2H,cAAL,CAAoBY,OAApB,CAA4BvI,CAAC,CAAC0D,GAA9B,IAAqC,CAAC,CAAtC,IAA2C;AAC1C1D,WAAC,CAAC0D,GAAF,KAAU,GAAV,IAAiB1D,CAAC,CAAC2D,OAAF,KAAc,IADhC,IACyC;AACxC3D,WAAC,CAAC0D,GAAF,KAAU,GAAV,IAAiB1D,CAAC,CAAC2D,OAAF,KAAc,IAFhC,IAEyC;AACxC3D,WAAC,CAAC0D,GAAF,KAAU,GAAV,IAAiB1D,CAAC,CAAC2D,OAAF,KAAc,IAHhC,IAGyC;AACxC3D,WAAC,CAAC0D,GAAF,KAAU,GAAV,IAAiB1D,CAAC,CAAC2D,OAAF,KAAc,IAJhC,IAIyC;AACxC3D,WAAC,CAAC0D,GAAF,KAAU,GAAV,IAAiB1D,CAAC,CAAC4D,OAAF,KAAc,IALhC,IAKyC;AACxC5D,WAAC,CAAC0D,GAAF,KAAU,GAAV,IAAiB1D,CAAC,CAAC4D,OAAF,KAAc,IANhC,IAMyC;AACxC5D,WAAC,CAAC0D,GAAF,KAAU,GAAV,IAAiB1D,CAAC,CAAC4D,OAAF,KAAc,IAPhC,IAOyC;AACxC5D,WAAC,CAAC0D,GAAF,KAAU,GAAV,IAAiB1D,CAAC,CAAC4D,OAAF,KAAc,IATjC,CASwC;AACvC;AAVD,YAWE;AACD;AACA;AACA,aAhBiC,CAkBlC;;;AACA,cAAI5D,CAAC,CAAC0D,GAAF,KAAU,GAAV,IAAiBwC,KAAK,CAACmC,MAAM,CAACrI,CAAC,CAAC0D,GAAH,CAAP,CAA1B,EAA2C;AAC1C1D,aAAC,CAACwI,cAAF;AACA,WArBiC,CAuBlC;;;AACA,cAAI,KAAKN,KAAT,EAAgB;AACf,gBAAMO,gBAAgB,GAAG,KAAKC,aAAL,CAAmB1I,CAAC,CAAC0D,GAArB,CAAzB;;AACA,gBAAI,CAAC,KAAKwE,KAAL,CAAWS,IAAX,CAAgBF,gBAAhB,CAAL,EAAwC;AACvCzI,eAAC,CAACwI,cAAF;AACA;AACD;;AAED,cAAMI,QAAQ,GAAGP,MAAM,CAAC,KAAKK,aAAL,CAAmB1I,CAAC,CAAC0D,GAArB,CAAD,CAAvB;;AAEA,cAAIkF,QAAQ,GAAG,KAAKd,GAAhB,IAAuBc,QAAQ,GAAG,KAAKhB,GAA3C,EAAgD;AAC/C5H,aAAC,CAACwI,cAAF;AACA;AACD;;;sCAEqB9E,G,EAAW;AAChC,cAAMmF,cAAc,GAAG,KAAKd,YAAL,CAAkBc,cAAzC;AACA,cAAMC,YAAY,GAAG,KAAKf,YAAL,CAAkBe,YAAvC;AACA,cAAMC,QAAQ,GAAG,KAAKhB,YAAL,CAAkBrG,KAAnC;AACA,cAAMsH,SAAS,GAAGD,QAAQ,CAACE,SAAT,CAAmBJ,cAAnB,EAAmCC,YAAnC,CAAlB;AACA,iBAAOE,SAAS,GACbD,QAAQ,CAAChF,OAAT,CAAiBiF,SAAjB,EAA4BtF,GAA5B,CADa,GAEbqF,QAAQ,CAACE,SAAT,CAAmB,CAAnB,EAAsBJ,cAAtB,IACFnF,GADE,GAEFqF,QAAQ,CAACE,SAAT,CAAmBJ,cAAnB,CAJD;AAKA;;;;;;;uBA7FWpB,kB,EAAkB,yH;AAAA,K;;;YAAlBA,kB;AAAkB,2C;AAAA;AAAA;;mBAAlB,qB;AAAiB,W;;;;;;;;;;;;;sEAAjBA,kB,EAAkB;cAH9B,uDAG8B;eAHpB;AACVhF,kBAAQ,EAAE;AADA,S;AAGoB,Q;;;;;;gBAiB7B;;;gBACA;;;gBACA;;;gBAyBA,0D;iBAAa,S,EAAW,CAAC,QAAD,C;;;;;;;;;;;;;;;;;;;;AC/C1B;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;;AAAA,QAAYyG,eAAZ;;AAAA,eAAYA,eAAZ,EAA2B;AAC1B;AACA;AACA;AACA,KAJD,EAAYA,eAAe,KAAfA,eAAe,MAA3B;;AAMA,QAAYC,kBAAZ;;AAAA,eAAYA,kBAAZ,EAA8B;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA,KAPD,EAAYA,kBAAkB,KAAlBA,kBAAkB,MAA9B;;AASA,QAAYC,yBAAZ;;AAAA,eAAYA,yBAAZ,EAAqC;AACpC;AACA;AACA;AACA;AACA;AACA,KAND,EAAYA,yBAAyB,KAAzBA,yBAAyB,MAArC;;AA2BO,QAAMC,WAAW,GAA4C;AACnEC,gBAAU,EAAE;AACXvH,YAAI,EAAE,aADK;AAEXsC,cAAM,EAAE,EAFG;AAGXkF,aAAK,EAAE,4BAHI;AAIX9C,iBAAS,EAAE,CAJA;AAKXwB,eAAO,EAAE;AALE,OADuD;AAQnEuB,UAAI,EAAE;AACLzH,YAAI,EAAE,MADD;AAELsC,cAAM,EAAE,EAFH;AAGLkF,aAAK,EAAE,8BAHF;AAIL9C,iBAAS,EAAE,CAJN;AAKLwB,eAAO,EAAE;AALJ,OAR6D;AAenEwB,aAAO,EAAE;AACR1H,YAAI,EAAE,EADE;AAERsC,cAAM,EAAE,CAFA;AAGRkF,aAAK,EAAE,8BAHC;AAIR9C,iBAAS,EAAE,CAJH;AAKRwB,eAAO,EAAE;AALD;AAf0D,KAA7D;AA6BA,QAAMyB,MAAM,GAAuB,CACzC;AACC3H,UAAI,EAAE,OADP;AAECL,WAAK,EAAE;AAFR,KADyC,EAKzC;AACCK,UAAI,EAAE,OADP;AAECL,WAAK,EAAE;AAFR,KALyC,EASzC;AACCK,UAAI,EAAE,OADP;AAECL,WAAK,EAAE;AAFR,KATyC,EAazC;AACCK,UAAI,EAAE,OADP;AAECL,WAAK,EAAE;AAFR,KAbyC,EAiBzC;AACCK,UAAI,EAAE,OADP;AAECL,WAAK,EAAE;AAFR,KAjByC,EAqBzC;AACCK,UAAI,EAAE,OADP;AAECL,WAAK,EAAE;AAFR,KArByC,EAyBzC;AACCK,UAAI,EAAE,OADP;AAECL,WAAK,EAAE;AAFR,KAzByC,EA6BzC;AACCK,UAAI,EAAE,OADP;AAECL,WAAK,EAAE;AAFR,KA7ByC,EAiCzC;AACCK,UAAI,EAAE,OADP;AAECL,WAAK,EAAE;AAFR,KAjCyC,EAqCzC;AACCK,UAAI,EAAE,QADP;AAECL,WAAK,EAAE;AAFR,KArCyC,EAyCzC;AACCK,UAAI,EAAE,QADP;AAECL,WAAK,EAAE;AAFR,KAzCyC,EA6CzC;AACCK,UAAI,EAAE,QADP;AAECL,WAAK,EAAE;AAFR,KA7CyC,CAAnC;AAmDA,QAAMiI,KAAK,GAAkB,CAAC,MAAD,EAAS,MAAT,EAAiB,MAAjB,EAAyB,MAAzB,EAAiC,MAAjC,CAA7B;;;;;;;;;;;;;;;;AC5HP;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;;AAEO,QAAMC,MAAM,GAAG,SAATA,MAAS,CAAClI,KAAD,EAAgBmI,WAAhB,EAAiD;AAEtE,UAAInI,KAAK,KAAKoI,SAAV,IAAuBpI,KAAK,IAAI,IAAhC,IAAwCA,KAAK,KAAK,EAAtD,EAA0D;AACzD,eAAO,KAAP;AACA;;AAED,UAAMvB,IAAI,GAAkB4J,MAAM,CAAC5J,IAAP,CAAY0J,WAAZ,CAA5B;AACA,UAAMG,CAAC,GAAW7J,IAAI,CAACkE,MAAvB;AAEA,UAAI4F,CAAJ;;AACA,WAAKA,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAGD,CAAhB,EAAmB,EAAEC,CAArB,EAAwB;AACvB,YAAIvI,KAAK,KAAKmI,WAAW,CAAC1J,IAAI,CAAC8J,CAAD,CAAL,CAAzB,EAAoC;AACnC,iBAAO,IAAP;AACA;AACD;;AAED,aAAO,KAAP;AACA,KAjBM;;AAmBA,QAAMC,WAAW,GAAG,SAAdA,WAAc,CAAC1I,UAAD,EAAyC;AACnE;AACA,UAAMgE,gBAAgB,GAAWhE,UAAU,CAACuC,OAAX,CAAmB,OAAnB,EAA4B,EAA5B,CAAjC,CAFmE,CAInE;;AACA,UAAMoG,KAAK,GAAkBJ,MAAM,CAACK,MAAP,CAAc,uDAAd,CAA7B;;AACA,gCAA6BD,KAA7B,4BAAoC;AAA/B,YAAME,cAAc,aAApB;AACJ;AACA,YAAMC,IAAI,GAAG,oDAAYD,cAAZ,CAAb;AACA,YAAMpC,OAAO,GAAGqC,IAAI,CAACrC,OAArB;;AACA,YAAIA,OAAO,KAAK,IAAZ,IAAoBzC,gBAAgB,CAAC1B,KAAjB,CAAuBmE,OAAvB,CAAxB,EAAyD;AACxD,iBAAOoC,cAAP;AACA;AACD;;AAED,aAAO,wDAAgB7G,OAAvB;AACA,KAhBM;;AAkBA,QAAM+G,eAAe,GAAG,SAAlBA,eAAkB,CAAC/I,UAAD,EAAqBgJ,kBAArB,EAA6D;AAC3F,UAAI,CAACZ,MAAM,CAACY,kBAAD,EAAqB,uDAArB,CAAX,EAAkD;AACjD,eAAO,KAAP;AACA;;AAED,UAAMF,IAAI,GAA4B,oDAAYE,kBAAZ,CAAtC;AACA,UAAMnE,MAAM,GAAW7E,UAAU,CAACuC,OAAX,CAAmB,IAAnB,EAAyB,EAAzB,EAA6BM,MAApD;;AAEA,UAAIiG,IAAI,CAACG,SAAL,KAAmBX,SAAnB,IAAgCQ,IAAI,CAACI,SAAL,KAAmBZ,SAAvD,EAAkE;AACjE,eAAOzD,MAAM,IAAIiE,IAAI,CAACG,SAAf,IAA4BpE,MAAM,IAAIiE,IAAI,CAACI,SAAlD;AACA;;AAED,aAAOrE,MAAM,KAAKiE,IAAI,CAACjG,MAAvB;AACA,KAbM;;AAeA,QAAMsG,WAAW,GAAG,SAAdA,WAAc,CAACnJ,UAAD,EAAiC;AAC3D;AACA,UAAMoJ,SAAS,GAAkBpJ,UAAU,CAACqJ,KAAX,CAAiB,EAAjB,EAAqBC,OAArB,GAA+BC,GAA/B,CAAmC,UAAC9E,GAAD;AAAA,eAAyB,CAACA,GAA1B;AAAA,OAAnC,CAAjC;AACA,UAAM+E,GAAG,GAAWJ,SAAS,CAACvG,MAA9B;AAEA,UAAI2F,CAAC,GAAG,CAAR;AACA,UAAIiB,GAAG,GAAG,CAAV;AACA,UAAIC,CAAC,GAAG,CAAR;AAEA,UAAIC,KAAJ;;AACA,aAAOD,CAAC,GAAGF,GAAX,EAAgB;AACfG,aAAK,GAAGP,SAAS,CAACZ,CAAD,CAAjB;AACAmB,aAAK,GAAG,CAACA,KAAT;;AAEA,YAAInB,CAAC,GAAG,CAAR,EAAW;AACVmB,eAAK,IAAI,CAAT;AAEAF,aAAG,IAAKE,KAAK,GAAG,EAAT,GAAeA,KAAf,GAAuBA,KAAK,GAAG,CAAtC;AACA,SAJD,MAIO;AACNF,aAAG,IAAIE,KAAP;AACA;;AAEDnB,SAAC,GAAG,EAAEkB,CAAN;AACA;;AAED,aAAOD,GAAG,GAAG,EAAN,KAAa,CAApB;AACA,KA1BM;;;;;;;;;;;;;;;;;ACtDP;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;;QAKaG,Q;;;;;;;kCAEK1J,K,EAAe2J,I,EAAU;AACzC,2BAAU/E,IAAI,CAACC,KAAL,CAAW7E,KAAK,GAAG,EAAnB,CAAV,cAAoC,CAAC,MAAOA,KAAK,GAAG,EAAhB,EAAqB4J,KAArB,CAA2B,CAAC,CAA5B,CAApC;AACA;;;;;;;uBAJWF,Q;AAAQ,K;;;;YAARA,Q;AAAQ;;;;;sEAARA,Q,EAAQ;cAHpB,kDAGoB;eAHf;AACLrJ,cAAI,EAAE;AADD,S;AAGe,Q;;;;;;;;;;;;;;;;;;ACLrB;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;;QAQawJ,gB;AAWZ,gCACS7D,EADT,EAES8D,QAFT,EAGkBC,GAHlB,EAGuC;AAAA;;AAF9B,aAAA/D,EAAA,GAAAA,EAAA;AACA,aAAA8D,QAAA,GAAAA,QAAA;AACS,aAAAC,GAAA,GAAAA,GAAA;AALV,aAAAC,MAAA,GAAS,EAAT;AAMH;;;;oCAEc1D,O,EAAwB;AAC1C,cAAIA,OAAO,CAAC2D,WAAZ,EAAyB;AACxB,gBAAI,KAAKA,WAAL,IAAoB,KAAKC,MAAL,EAApB,IAAqC,CAAC,KAAKC,OAA/C,EAAwD;AACvD,mBAAKC,IAAL;AACA,aAFD,MAEO,IAAI,KAAKD,OAAT,EAAkB;AACxB,mBAAKE,IAAL;AACA;AACD;AACD;;;uCAGqB,CACrB;AACA;AACA;AACA;;;uCAGqB,CACrB;AACA;AACA;AACA;;;+BAEc;AACd,eAAKC,MAAL;AACA,eAAKC,WAAL;AACA,eAAKT,QAAL,CAAcU,QAAd,CAAuB,KAAKL,OAA5B,EAAqC,iBAArC;AACA;;;+BAEc;AAAA;;AACd,eAAKL,QAAL,CAAcW,WAAd,CAA0B,KAAKN,OAA/B,EAAwC,iBAAxC;AACAO,gBAAM,CAACC,UAAP,CAAkB,YAAM;AACvB,iBAAI,CAACb,QAAL,CAAcc,WAAd,CAA0BC,QAAQ,CAACC,IAAnC,EAAyC,KAAI,CAACX,OAA9C;;AACA,iBAAI,CAACA,OAAL,GAAe,IAAf;AACA,WAHD,EAGG,CAAC,KAAKY,KAHT;AAIA;;;iCAEgB;AAChB,eAAKZ,OAAL,GAAe,KAAKL,QAAL,CAAckB,aAAd,CAA4B,KAA5B,CAAf;AACA,cAAMC,KAAK,GAAG,KAAKC,kBAAL,GACX,KAAKnB,GAAL,CAASoB,kBAAT,CAA4B,KAAKD,kBAAjC,EAAqDE,SAArD,CAA+D,CAA/D,CADW,GAEX,KAAKtB,QAAL,CAAcuB,UAAd,CAAyB,KAAKC,YAA9B,CAFH;AAGA,eAAKxB,QAAL,CAAcyB,WAAd,CAA0B,KAAKpB,OAA/B,EAAwCc,KAAxC;AACA,eAAKnB,QAAL,CAAcyB,WAAd,CAA0BV,QAAQ,CAACC,IAAnC,EAAyC,KAAKX,OAA9C;AACA,eAAKL,QAAL,CAAcU,QAAd,CAAuB,KAAKL,OAA5B,EAAqC,YAArC;AACA,eAAKL,QAAL,CAAcU,QAAd,CAAuB,KAAKL,OAA5B,uBAAmD,KAAKqB,SAAxD;AACA,eAAK1B,QAAL,CAAc2B,QAAd,CAAuB,KAAKtB,OAA5B,EAAqC,oBAArC,oBAAsE,KAAKY,KAA3E;AACA,eAAKjB,QAAL,CAAc2B,QAAd,CAAuB,KAAKtB,OAA5B,EAAqC,iBAArC,oBAAmE,KAAKY,KAAxE;AACA,eAAKjB,QAAL,CAAc2B,QAAd,CAAuB,KAAKtB,OAA5B,EAAqC,eAArC,oBAAiE,KAAKY,KAAtE;AACA,eAAKjB,QAAL,CAAc2B,QAAd,CAAuB,KAAKtB,OAA5B,EAAqC,YAArC,oBAA8D,KAAKY,KAAnE;AACA;;;sCAEqB;AACrB,cAAMW,OAAO,GAAG,KAAK1F,EAAL,CAAQpE,aAAR,CAAsB+J,qBAAtB,EAAhB;AACA,cAAMC,UAAU,GAAG,KAAKzB,OAAL,CAAawB,qBAAb,EAAnB;AACA,cAAME,SAAS,GAAGnB,MAAM,CAACoB,WAAP,IAAsBjB,QAAQ,CAACkB,eAAT,CAAyBC,SAA/C,IAA4DnB,QAAQ,CAACC,IAAT,CAAckB,SAA1E,IAAuF,CAAzG;AAEA,cAAIC,GAAJ;AACA,cAAIC,IAAJ;;AAEA,cAAI,KAAKV,SAAL,KAAmB,KAAvB,EAA8B;AAC7BS,eAAG,GAAGP,OAAO,CAACO,GAAR,GAAcL,UAAU,CAACO,MAAzB,GAAkC,KAAKnC,MAA7C;AACAkC,gBAAI,GAAGR,OAAO,CAACQ,IAAR,GAAe,CAACR,OAAO,CAACU,KAAR,GAAgBR,UAAU,CAACQ,KAA5B,IAAqC,CAA3D;AACA;;AAED,cAAI,KAAKZ,SAAL,KAAmB,QAAvB,EAAiC;AAChCS,eAAG,GAAGP,OAAO,CAACW,MAAR,GAAiB,KAAKrC,MAA5B;AACAkC,gBAAI,GAAGR,OAAO,CAACQ,IAAR,GAAe,CAACR,OAAO,CAACU,KAAR,GAAgBR,UAAU,CAACQ,KAA5B,IAAqC,CAA3D;AACA;;AAED,cAAI,KAAKZ,SAAL,KAAmB,MAAvB,EAA+B;AAC9BS,eAAG,GAAGP,OAAO,CAACO,GAAR,GAAc,CAACP,OAAO,CAACS,MAAR,GAAiBP,UAAU,CAACO,MAA7B,IAAuC,CAA3D;AACAD,gBAAI,GAAGR,OAAO,CAACQ,IAAR,GAAeN,UAAU,CAACQ,KAA1B,GAAkC,KAAKpC,MAA9C;AACA;;AAED,cAAI,KAAKwB,SAAL,KAAmB,OAAvB,EAAgC;AAC/BS,eAAG,GAAGP,OAAO,CAACO,GAAR,GAAc,CAACP,OAAO,CAACS,MAAR,GAAiBP,UAAU,CAACO,MAA7B,IAAuC,CAA3D;AACAD,gBAAI,GAAGR,OAAO,CAACY,KAAR,GAAgB,KAAKtC,MAA5B;AACA;;AAED,eAAKF,QAAL,CAAc2B,QAAd,CAAuB,KAAKtB,OAA5B,EAAqC,KAArC,YAA+C8B,GAAG,GAAGJ,SAArD;AACA,eAAK/B,QAAL,CAAc2B,QAAd,CAAuB,KAAKtB,OAA5B,EAAqC,MAArC,YAAgD+B,IAAhD;AACA;;;iCAEgB;AAChB,iBAAO,KAAKhB,kBAAL,IAA2B,KAAKI,YAAvC;AACA;;;;;;;uBAxGWzB,gB,EAAgB,yH,EAAA,wH,EAAA,+H;AAAA,K;;;YAAhBA,gB;AAAgB,yC;AAAA;AAAA;;mBAAhB,kB;AAAc,W,EAAA,Y,EAAA;AAAA,mBAAd,kBAAc;AAAA,W;;;;;;;;;;;;;;;sEAAdA,gB,EAAgB;cAH5B,uDAG4B;eAHlB;AACV9I,kBAAQ,EAAE;AADA,S;AAGkB,Q;;;;;;;;;;gBAE3B;;;gBACA;;;gBACA;;;gBACA;;;gBACA;;;gBAqBA,0D;iBAAa,Y;;;gBAOb,0D;iBAAa,Y;;;;;;;;;;;;;;;;;;;;AC1Cf;AAAA;;;AAAA;AAAA;AAAA,O,CAAA;AACA;AACA;;;AAEO,QAAMwL,WAAW,GAAG;AACzBC,gBAAU,EAAE;AADa,KAApB;AAIP;;;;;;;AAOA;;;;;;;;;;;;;;;;;ACfA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;;AAMA,QAAI,sEAAYA,UAAhB,EAA4B;AAC1B;AACD;;AAED,gFAAyBC,eAAzB,CAAyC,yDAAzC,WACS,UAAAC,GAAG;AAAA,aAAIhM,OAAO,CAACiM,KAAR,CAAcD,GAAd,CAAJ;AAAA,KADZ","file":"main-es5.js","sourcesContent":["function webpackEmptyAsyncContext(req) {\n\t// Here Promise.resolve().then() is used instead of new Promise() to prevent\n\t// uncaught exception popping up in devtools\n\treturn Promise.resolve().then(function() {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t});\n}\nwebpackEmptyAsyncContext.keys = function() { return []; };\nwebpackEmptyAsyncContext.resolve = webpackEmptyAsyncContext;\nmodule.exports = webpackEmptyAsyncContext;\nwebpackEmptyAsyncContext.id = \"./$$_lazy_route_resource lazy recursive\";","import { NgModule } from '@angular/core';\r\nimport { Routes, RouterModule } from '@angular/router';\r\n\r\n\r\nconst routes: Routes = [];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forRoot(routes)],\r\n  exports: [RouterModule]\r\n})\r\nexport class AppRoutingModule { }\r\n","import { ChangeDetectionStrategy, Component, OnInit, ViewChild } from \"@angular/core\";\r\nimport { FormControl, FormGroup } from \"@angular/forms\";\r\nimport { Observable, timer } from \"rxjs\";\r\nimport { scan, takeWhile } from \"rxjs/operators\";\r\nimport { CreditCardComponent } from \"./credit-card/credit-card.component\";\r\nimport { CreditCardGroupComponents } from \"./domain\";\r\n\r\n@Component({\r\n\tchangeDetection: ChangeDetectionStrategy.OnPush,\r\n\tselector: \"app-root\",\r\n\ttemplateUrl: \"./app.component.html\",\r\n\tstyleUrls: [\"./app.component.scss\"]\r\n})\r\nexport class AppComponent implements OnInit {\r\n\r\n\t// Countdown timer\r\n\t// TODO: unsubscribe??\r\n\tpublic timerSeconds = 900;\r\n\tpublic timer$: Observable<number>;\r\n\r\n\t// Form group representing the entire payment form\r\n\tpublic paymentForm: FormGroup;\r\n\r\n\t// Reference to the credit card component used to handle credit-card input and FE processing\r\n\t@ViewChild(CreditCardComponent, { static: true })\r\n\tpublic creditCardComponent: CreditCardComponent;\r\n\r\n\r\n\tpublic ngOnInit() {\r\n\r\n\t\t// TODO: add validators and other processing for the name, etc\r\n\t\tthis.paymentForm = new FormGroup({\r\n\t\t\tcreditCard: this.creditCardComponent.creditCardSubGroup,\r\n\t\t\temailReceipt: new FormControl(false),\r\n\t\t});\r\n\r\n\t\t// Initiate countdown timer\r\n\t\tthis.timer$ = timer(0, 1000).pipe(\r\n\t\t\tscan(acc => --acc, this.timerSeconds),\r\n\t\t\ttakeWhile(x => x >= 0)\r\n\t\t);\r\n\t}\r\n\r\n\tpublic onSubmit(): void {\r\n\t\tconst ccGroup: FormGroup = this.paymentForm.controls.creditCard as FormGroup;\r\n\t\tconst cardNumber: string = ccGroup.controls[CreditCardGroupComponents.CREDIT_CARD_NUMBER].value;\r\n\t\tconst expMonth: string = ccGroup.controls[CreditCardGroupComponents.EXPIRATION_MONTH].value;\r\n\t\tconst expYear: string = ccGroup.controls[CreditCardGroupComponents.EXPIRATION_YEAR].value;\r\n\t\tconst name: string = ccGroup.controls[CreditCardGroupComponents.NAME].value;\r\n\t\tconst cvv: string = ccGroup.controls[CreditCardGroupComponents.CVV].value;\r\n\t\tconst emailReceipt: string = this.paymentForm.get(\"emailReceipt\").value;\r\n\r\n\t\tconsole.log(\"Name  \t      :\", name);\r\n\t\tconsole.log(\"Card Number  :\", cardNumber);\r\n\t\tconsole.log(\"Exp. Month   :\", expMonth);\r\n\t\tconsole.log(\"Exp. Year    :\", expYear);\r\n\t\tconsole.log(\"CVV          :\", cvv);\r\n\t\tconsole.log(\"Email receipt:\", emailReceipt);\r\n\t}\r\n\r\n\r\n}\r\n","<section>\r\n\t<img src=\"../assets/images/logo.png\" />\r\n\t<div>\r\n\t\tДо окончания сессии осталось\r\n\t\t<span>{{ timer$ | async | time}}</span>\r\n\t</div>\r\n\r\n</section>\r\n\r\n<section>\r\n\t<div>Оплата:&nbsp;&nbsp;325,00 BYN</div>\r\n\t<div>Номер заявки:&nbsp;&nbsp;34875398</div>\r\n\t<div>Получатель:&nbsp;&nbsp;Shop name</div>\r\n</section>\r\n\r\n<form [formGroup]=\"paymentForm\" (ngSubmit)=\"onSubmit()\" autocomplete=\"off\">\r\n\r\n\t<div class=\"main-block-wrap\">\r\n\r\n\t\t<app-credit-card></app-credit-card>\r\n\r\n\t\t<div class=\"info-block\">\r\n\t\t\t<div class=\"cc-icons\">\r\n\t\t\t\t<img src=\"../assets/images/visa.png\" alt=\"Visa\">\r\n\t\t\t\t<img src=\"../assets/images/ms.png\" alt=\"Mastercard\">\r\n\t\t\t\t<img src=\"../assets/images/belkart.png\" alt=\"Belkart\">\r\n\t\t\t\t<img src=\"../assets/images/unionpay.png\" alt=\"Unionpay\">\r\n\t\t\t</div>\r\n\t\t\t<p>Интернет-платежи защищены сертификатом SSL и протоколом 3D-Secure и не передает магазинам платежные данные в том числе и данные карты </p>\r\n\t\t</div>\r\n\r\n\t</div>\r\n\r\n\t<div class=\"bottom-block-wrap\">\r\n\r\n\t\t<label><input type=\"checkbox\" formControlName=\"emailReceipt\"> Получать квитанцию на e-mail</label>\r\n\r\n\t\t<button class=\"app\" type=\"submit\" [disabled]=\"!creditCardComponent.valid\">Оплатить</button>\r\n\r\n\t</div>\r\n\r\n\r\n\r\n</form>\r\n\r\n<!-- <router-outlet></router-outlet> -->\r\n","import { NgModule } from \"@angular/core\";\r\nimport { ReactiveFormsModule } from \"@angular/forms\";\r\nimport { BrowserModule } from \"@angular/platform-browser\";\r\nimport { NgxMaskModule } from \"ngx-mask\";\r\nimport { AppRoutingModule } from \"./app-routing.module\";\r\nimport { AppComponent } from \"./app.component\";\r\nimport { CreditCardNumberDirective } from \"./credit-card-number.directive\";\r\nimport { CreditCardComponent } from \"./credit-card/credit-card.component\";\r\nimport { DigitOnlyDirective } from \"./digit-only.directive\";\r\nimport { TimePipe } from \"./time.pipe\";\r\nimport { TooltipDirective } from \"./tooltip.directive\";\r\n\r\n@NgModule({\r\n\tdeclarations: [\r\n\t\tAppComponent,\r\n\t\tCreditCardComponent,\r\n\t\tCreditCardNumberDirective,\r\n\t\tTooltipDirective,\r\n\t\tTimePipe,\r\n\t\tDigitOnlyDirective\r\n\t],\r\n\timports: [\r\n\t\tBrowserModule,\r\n\t\tAppRoutingModule,\r\n\t\tReactiveFormsModule,\r\n\t\tNgxMaskModule.forRoot(),\r\n\t],\r\n\tproviders: [],\r\n\tbootstrap: [AppComponent]\r\n})\r\nexport class AppModule { }\r\n","import { Directive, ElementRef, EventEmitter, HostListener, OnInit, Output } from \"@angular/core\";\r\nimport { CREDIT_CARD_ERRORS, CreditCardTypes } from \"./domain\";\r\nimport { getCardType, isCCLengthValid, isValidLuhn } from \"./lib\";\r\n\r\n@Directive({\r\n\tselector: \"[appCreditCardNumber]\"\r\n})\r\nexport class CreditCardNumberDirective implements OnInit {\r\n\r\n\t// Direct reference to the Input element\r\n\tprotected input: HTMLInputElement;\r\n\r\n\t// Credit card type is detected (other than unknown)\r\n\t@Output() public cardTypeChange = new EventEmitter<CreditCardTypes>();\r\n\r\n\t// Valid credit card number detected\r\n\t@Output() public cardNumberChange = new EventEmitter<string>();\r\n\r\n\t// Error detected while typing credit-card number\r\n\t@Output() public cardErrorChange = new EventEmitter<string>();\r\n\r\n\tpublic constructor(\r\n\t\tprotected elementRef: ElementRef,\r\n\t) {\r\n\t\tthis.input = this.elementRef.nativeElement as HTMLInputElement;\r\n\t}\r\n\r\n\tpublic ngOnInit() {\r\n\t\tthis.cardTypeChange.emit(CreditCardTypes.UNKNOWN);\r\n\t}\r\n\r\n\t// Access the current credit-card number length\r\n\tpublic get length(): number {\r\n\t\treturn this.input.value.length;\r\n\t}\r\n\r\n\r\n\t// TODO: refactor\r\n\t// HostListener fires change detection; consider RxJS fromEvent() as an alternative\r\n\t@HostListener(\"keydown\", [\"$event\"])\r\n\tpublic onKeyDown(evt: KeyboardEvent): boolean {\r\n\t\tconst key: string = evt.key;\r\n\r\n\t\tif (\r\n\t\t\t// Allow: Delete, Backspace, Tab, Escape, Enter, etc\r\n\t\t\t// this.navigationKeys.indexOf(key) > -1 ||\r\n\t\t\t(key === \"a\" && evt.ctrlKey === true) || // Allow: Ctrl+A\r\n\t\t\t(key === \"c\" && evt.ctrlKey === true) || // Allow: Ctrl+C\r\n\t\t\t(key === \"v\" && evt.ctrlKey === true) || // Allow: Ctrl+V\r\n\t\t\t(key === \"x\" && evt.ctrlKey === true) || // Allow: Ctrl+X\r\n\t\t\t(key === \"a\" && evt.metaKey === true) || // Cmd+A (Mac)\r\n\t\t\t(key === \"c\" && evt.metaKey === true) || // Cmd+C (Mac)\r\n\t\t\t(key === \"v\" && evt.metaKey === true) || // Cmd+V (Mac)\r\n\t\t\t(key === \"x\" && evt.metaKey === true) // Cmd+X (Mac)\r\n\t\t) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\t// Some characters are OK (for selecting/deselecting/etc)\r\n\t\tif (key === \"Shift\" || key === \"ArrowLeft\" || key === \"ArrowRight\"\r\n\t\t\t|| key === \"Control\" || key === \"Alt\" || key === \"Tab\"\r\n\t\t\t|| key === \"Home\" || key === \"End\") {\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\t// Backspace and Delete are okay\r\n\t\tconst code = evt.code.toLowerCase();\r\n\t\tif (code === \"backspace\" || code === \"delete\") {\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\tconst value: RegExpMatchArray = key.match(/[\\d -]+/);\r\n\r\n\t\tif (value == null) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\t}\r\n\r\n\t@HostListener(\"keyup\")\r\n\tpublic onKeyUp(): boolean {\r\n\t\tconst cardNumber: string = this.input.value.replace(\" \", \"\");\r\n\r\n\t\t/*\r\n\t\t  Note:  In general, 2-4 digits is all it takes to identify the card type; after that, this test is redundant.\r\n\t\t  TODO: Make this more efficient\r\n\t\t */\r\n\t\tconst cardType: CreditCardTypes = getCardType(cardNumber);\r\n\r\n\t\tif (cardType === CreditCardTypes.UNKNOWN) {\r\n\t\t\tthis.cardErrorChange.emit(CREDIT_CARD_ERRORS.UNSUPPORTED_CARD);\r\n\t\t\treturn false;\r\n\t\t} else {\r\n\t\t\tthis.cardTypeChange.emit(cardType);\r\n\t\t}\r\n\r\n\t\tif (!isCCLengthValid(cardNumber, cardType)) {\r\n\t\t\tthis.cardErrorChange.emit(CREDIT_CARD_ERRORS.INVALID_LENGTH);\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tif (!isValidLuhn(cardNumber)) {\r\n\t\t\tthis.cardErrorChange.emit(CREDIT_CARD_ERRORS.INVALID_NUMBER);\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tthis.cardErrorChange.emit(CREDIT_CARD_ERRORS.NONE);\r\n\t\tthis.cardNumberChange.emit(cardNumber);\r\n\r\n\t\treturn true;\r\n\t}\r\n\r\n}\r\n","import { ChangeDetectionStrategy, Component, Input, OnInit, ViewChild } from \"@angular/core\";\r\nimport { FormControl, FormGroup, Validators } from \"@angular/forms\";\r\nimport { CreditCardNumberDirective } from \"../credit-card-number.directive\";\r\nimport { CREDIT_CARD_ERRORS, creditCards, CreditCardTypes, months, years } from \"../domain\";\r\n\r\n@Component({\r\n\tchangeDetection: ChangeDetectionStrategy.OnPush,\r\n\tselector: \"app-credit-card\",\r\n\ttemplateUrl: \"./credit-card.component.html\",\r\n\tstyleUrls: [\"./credit-card.component.scss\"],\r\n})\r\nexport class CreditCardComponent implements OnInit {\r\n\t@Input() public placeHolder = \"Введите номер карты\";\r\n\r\n\r\n\t// Make visible to template\r\n\tpublic CreditCardErrors = CREDIT_CARD_ERRORS;\r\n\tpublic creditCardData = creditCards;\r\n\tpublic monthData = months;\r\n\tpublic yearData = years;\r\n\r\n\t// The sub-form for which this component is responsible\r\n\tpublic creditCardSubGroup: FormGroup;\r\n\r\n\tpublic cardType: string = CreditCardTypes.UNKNOWN;\r\n\r\n\t// Current month and full year\r\n\tprotected currentMonth: number;\r\n\tprotected currentYear: number;\r\n\r\n\t// cache currently selected month/year\r\n\tprotected selectedMonth: number;\r\n\tprotected selectedYear: number;\r\n\r\n\t// references to form controls for quick property access/enable/disable\r\n\tprotected expirationMonth: FormControl;\r\n\tprotected expirationYear: FormControl;\r\n\tprotected name: FormControl;\r\n\tprotected cvv: FormControl;\r\n\r\n\t// Various errors that may occur while typing/interacting with the sub-form\r\n\tpublic cardError: string = CREDIT_CARD_ERRORS.NONE;\r\n\tpublic expError: string = CREDIT_CARD_ERRORS.NONE;\r\n\tpublic cvvError: string = CREDIT_CARD_ERRORS.NONE;\r\n\r\n\t// Reference to the {CreditCardNumberDirective} that controls interactivity with the credit card number input\r\n\t@ViewChild(CreditCardNumberDirective, { static: true })\r\n\tprotected creditCardNumberInput: CreditCardNumberDirective;\r\n\r\n\tpublic constructor() {\r\n\r\n\t\tconst theDate: Date = new Date();\r\n\t\tthis.currentMonth = theDate.getMonth();\r\n\t\tthis.currentYear = theDate.getFullYear();\r\n\t\t// this.selectedYear = this.currentYear;\r\n\t\t// this.selectedMonth = this.currentMonth;\r\n\r\n\t\tthis.expirationMonth = new FormControl(null, Validators.required);\r\n\t\tthis.expirationYear = new FormControl(null, Validators.required);\r\n\t\tthis.name = new FormControl(null, Validators.required);\r\n\t\tthis.cvv = new FormControl(null, Validators.required);\r\n\r\n\t\tthis.creditCardSubGroup = new FormGroup({\r\n\t\t\tcreditCardNumber: new FormControl(null, Validators.required),\r\n\t\t\texpirationMonth: this.expirationMonth,\r\n\t\t\texpirationYear: this.expirationYear,\r\n\t\t\tname: this.name,\r\n\t\t\tcvv: this.cvv,\r\n\t\t});\r\n\t}\r\n\r\n\tpublic ngOnInit() {\r\n\t}\r\n\r\n\t// TODO: adjust\r\n\tpublic get valid(): boolean {\r\n\t\treturn this.creditCardSubGroup.valid\r\n\t\t\t&& this.isValidCardNumber && this.isValidExpDate && this.isValidCVV;\r\n\t}\r\n\r\n\r\n\t// Is the currently entered credit-card number valid?\r\n\tpublic get isValidCardNumber(): boolean {\r\n\t\treturn this.cardType !== CreditCardTypes.UNKNOWN\r\n\t\t\t&& this.creditCardNumberInput.length > 0\r\n\t\t\t&& this.cardError === CREDIT_CARD_ERRORS.NONE;\r\n\t}\r\n\r\n\t// Is the currently set expiration date (month and year) valid?\r\n\tpublic get isValidExpDate(): boolean {\r\n\t\t// The year may be greater than the current year (any month is okay) or if equal to the current year, the month can not be less\r\n\t\treturn this.selectedYear > this.currentYear\r\n\t\t\t|| (this.selectedMonth >= this.currentMonth\r\n\t\t\t\t&& this.currentYear === this.selectedYear);\r\n\t}\r\n\r\n\t// Is the currently entered CVV valid?\r\n\tpublic get isValidCVV(): boolean {\r\n\t\treturn this.cvvTouched && this.cvvError === CREDIT_CARD_ERRORS.NONE;\r\n\t}\r\n\r\n\r\n\t// Has the credit-card number field been 'touched' or dirty?\r\n\tpublic get creditCardNumberTouched(): boolean {\r\n\t\treturn this.creditCardSubGroup.get(\"creditCardNumber\").dirty;\r\n\t}\r\n\r\n\t// Has the CVV number field been 'touched' or dirty?\r\n\tpublic get cvvTouched(): boolean {\r\n\t\treturn this.cvv.dirty;\r\n\t}\r\n\r\n\tpublic get expDateTouched(): boolean {\r\n\t\treturn this.expirationMonth.dirty && this.expirationYear.dirty;\r\n\t}\r\n\r\n\r\n\t// Access the class(es) for the credit-card number {Input} based on current entry\r\n\tpublic get creditCardNumberClass(): string {\r\n\t\tlet className = \"app \";\r\n\r\n\t\tif (!this.creditCardNumberTouched) {\r\n\t\t\tclassName += \" ng-pristine\";\r\n\t\t} else {\r\n\t\t\tclassName += this.isValidCardNumber ? \" ng-valid\" : \"ng-invalid\";\r\n\t\t}\r\n\r\n\t\treturn className;\r\n\t}\r\n\r\n\t// Access the class(es) for the CVV {Input} based on overall sub-component state and current entry\r\n\tpublic get cvvClass(): string {\r\n\t\tlet className = \"app app-cvv\";\r\n\r\n\t\tif (!this.cvvTouched) {\r\n\t\t\t// Add pristine\r\n\t\t\tclassName += \" ng-pristine\";\r\n\t\t} else {\r\n\t\t\t// could be valid or invalid\r\n\t\t\tclassName += this.cvvError !== CREDIT_CARD_ERRORS.NONE ? \" ng-invalid\" : \" ng-valid\";\r\n\t\t}\r\n\r\n\t\treturn className;\r\n\t}\r\n\r\n\r\n\tpublic onCardNumberChange(cardNumber: string): void {\r\n\t\tif (cardNumber.length > 0 && this.cardError === CREDIT_CARD_ERRORS.NONE) {\r\n\t\t\tthis.expirationMonth.enable();\r\n\t\t\tthis.expirationYear.enable();\r\n\t\t\tthis.cvv.enable();\r\n\t\t}\r\n\r\n\t\t// TODO: If enabled once and the user goes back to re-type a new card number, disable these controls again\r\n\t}\r\n\r\n\tpublic onCardTypeChange(type: CreditCardTypes): void {\r\n\t\tif (type !== CreditCardTypes.UNKNOWN) {\r\n\t\t\tthis.cardType = type;\r\n\t\t}\r\n\t}\r\n\r\n\tpublic onCardErrorChange(evt: string): void {\r\n\t\tthis.cardError = evt;\r\n\t}\r\n\r\n\tpublic onMonthChanged(evt: Event): void {\r\n\t\tconst monthValue: number = +(evt.target as HTMLInputElement).value;\r\n\r\n\t\t// if (isNaN(monthValue)) {\r\n\t\t// \tthis.expError = CREDIT_CARD_ERRORS.INVALID_DATE;\r\n\t\t// \treturn;\r\n\t\t// }\r\n\t\tthis.selectedMonth = monthValue;\r\n\t\tthis.validateExpDate(monthValue);\r\n\t\t// this.expError = (this.selectedMonth < this.currentMonth && this.currentYear === this.selectedYear)\r\n\t\t// \t? CREDIT_CARD_ERRORS.INVALID_DATE\r\n\t\t// \t: CREDIT_CARD_ERRORS.NONE;\r\n\t}\r\n\r\n\tpublic onYearChanged(evt: Event): void {\r\n\t\tconst yearValue: number = +`20${(evt.target as HTMLInputElement).value}`;\r\n\r\n\t\t// if (isNaN(yearValue)) {\r\n\t\t// \tthis.expError = CREDIT_CARD_ERRORS.INVALID_DATE;\r\n\t\t// \treturn;\r\n\t\t// }\r\n\t\tthis.selectedYear = yearValue;\r\n\r\n\t\tthis.validateExpDate(yearValue);\r\n\r\n\t\t// if (this.currentYear > this.selectedYear) {\r\n\t\t// \tthis.expError = CREDIT_CARD_ERRORS.INVALID_DATE;\r\n\t\t// \treturn;\r\n\t\t// }\r\n\r\n\t\t// // newly selected year may override a previous invalid month\r\n\t\t// this.expError = this.selectedMonth < this.currentMonth && this.currentYear === this.selectedYear\r\n\t\t// \t? CREDIT_CARD_ERRORS.INVALID_DATE\r\n\t\t// \t: CREDIT_CARD_ERRORS.NONE;\r\n\t}\r\n\r\n\tprivate validateExpDate(val: number) {\r\n\t\tif (isNaN(val)) {\r\n\t\t\tthis.expError = CREDIT_CARD_ERRORS.INVALID_DATE;\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (this.currentYear > this.selectedYear) {\r\n\t\t\tthis.expError = CREDIT_CARD_ERRORS.INVALID_DATE;\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// newly selected year may override a previous invalid month\r\n\t\tthis.expError = this.selectedMonth < this.currentMonth && this.currentYear === this.selectedYear\r\n\t\t\t? CREDIT_CARD_ERRORS.INVALID_DATE\r\n\t\t\t: CREDIT_CARD_ERRORS.NONE;\r\n\t}\r\n\r\n\tpublic onCVVChanged(evt: Event): void {\r\n\t\tconst cvv: number = +(evt.target as HTMLInputElement).value;\r\n\r\n\t\tif (isNaN(cvv)) {\r\n\t\t\tthis.cvvError = CREDIT_CARD_ERRORS.INVALID_CCV;\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst digits: number = cvv === 0 ? 0 : Math.floor(Math.log10(cvv)) + 1;\r\n\r\n\t\t// Check the CVV length vs required length for the current card\r\n\t\tif (this.cardType !== CreditCardTypes.UNKNOWN) {\r\n\t\t\tthis.cvvError = digits === creditCards[this.cardType].cvvDigits\r\n\t\t\t\t? CREDIT_CARD_ERRORS.NONE\r\n\t\t\t\t: CREDIT_CARD_ERRORS.INVALID_CCV;\r\n\t\t} else {\r\n\t\t\t// Type a CVV without first providing a card number\r\n\t\t\tthis.cvvError = CREDIT_CARD_ERRORS.INVALID_CCV;\r\n\t\t}\r\n\t}\r\n}\r\n","<div [formGroup]=\"creditCardSubGroup\" class=\"credit-card-wrap\">\r\n\r\n\t<div class=\"cc-main-info-wrap\">\r\n\r\n\t\t<div class=\"form-line\">\r\n\t\t\t<!-- [class]=\"creditCardNumberClass\" -->\r\n\t\t\t<input mask=\"0000 0000 0000 0000\"\r\n\t\t\t\tappCreditCardNumber\r\n\t\t\t\tappTooltip\r\n\t\t\t\t[tooltipTemplateRef]=\"creditCardNumberErrorTemplate\"\r\n\t\t\t\t[showTooltip]=\"creditCardSubGroup.value.creditCardNumber && cardError === CreditCardErrors.INVALID_NUMBER || cardError === CreditCardErrors.UNSUPPORTED_CARD\"\r\n\t\t\t\tplacement=\"right\"\r\n\t\t\t\tclass=\"app\"\r\n\t\t\t\ttype=\"text\"\r\n\t\t\t\tid=\"creditCardNumber\"\r\n\t\t\t\tformControlName=\"creditCardNumber\"\r\n\t\t\t\tmaxlength=\"19\"\r\n\t\t\t\tinputmode=\"numeric\"\r\n\t\t\t\tpattern=\"[0-9]*\"\r\n\t\t\t\t(cardNumberChange)=\"onCardNumberChange($event)\"\r\n\t\t\t\t(cardTypeChange)=\"onCardTypeChange($event)\"\r\n\t\t\t\t(cardErrorChange)=\"onCardErrorChange($event)\"\r\n\t\t\t/>\r\n\t\t\t<span class=\"floating-label\">{{placeHolder}}</span>\r\n\r\n\t\t\t<img class=\"card-type-img\" *ngIf=\"cardType && cardType !== 'unknown'\" src=\"{{creditCardData[cardType].image}}\">\r\n\r\n\t\t\t<ng-template #creditCardNumberErrorTemplate>\r\n\t\t\t\t<div>\r\n\t\t\t\t\tВы указали неверный номер.<br/>\r\n\t\t\t\t\tПроверьте его и начните заново\r\n\t\t\t\t</div>\r\n\t\t\t</ng-template>\r\n\t\t</div>\r\n\r\n\t\t<!-- Тип карты: {{creditCardData[cardType].name}} -->\r\n\t\t<!--\r\n\t\t<span *ngIf=\"creditCardNumberTouched && !isValidCardNumber\">Ошибки: {{cardError}}</span> -->\r\n\r\n\t\t<!-- <br>\r\n\t\t{{creditCardSubGroup.value.creditCardNumber | json }} -->\r\n\t\t<!--  -->\r\n\r\n\t\t<div class=\"form-line date-exp-wrap\">\r\n\r\n\t\t\t<div class='year-wrap'>\r\n\t\t\t\t<input class=\"app app-month\"\r\n\t\t\t\t\tappDigitOnly\r\n\t\t\t\t\tid=\"expireMonth\"\r\n\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\tformControlName=\"expirationMonth\"\r\n\t\t\t\t\tmaxlength=\"2\"\r\n\t\t\t\t\tinputmode=\"numeric\"\r\n\t\t\t\t\tpattern=\"[0-9]*\"\r\n\t\t\t\t\tmin=\"0\"\r\n\t\t\t\t\tmax=\"12\"\r\n\t\t\t\t\t(change)=\"onMonthChanged($event)\" />\r\n\t\t\t\t<span class=\"floating-label\">Месяц</span>\r\n\t\t\t</div>\r\n\r\n\t\t\t<span class=\"month-year-separator\">/</span>\r\n\r\n\t\t\t<!-- [showTooltip]=\"creditCardSubGroup.value.creditCardNumber && cardError === CreditCardErrors.INVALID_NUMBER || cardError === CreditCardErrors.UNSUPPORTED_CARD\" -->\r\n\t\t\t<div class='year-wrap'>\r\n\t\t\t\t<input class=\"app app-year\"\r\n\t\t\t\t\tappTooltip\r\n\t\t\t\t\t[tooltipTemplateRef]=\"expDateTooltipTemplate\"\r\n\t\t\t\t\t[showTooltip]=\"expDateTouched && !isValidExpDate\"\r\n\t\t\t\t\tplacement=\"bottom\"\r\n\t\t\t\t\tappDigitOnly\r\n\t\t\t\t\tid=\"expireYear\"\r\n\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\tformControlName=\"expirationYear\"\r\n\t\t\t\t\tmaxlength=\"2\"\r\n\t\t\t\t\tinputmode=\"numeric\"\r\n\t\t\t\t\tpattern=\"[0-9]*\"\r\n\t\t\t\t\tmin=\"0\"\r\n\t\t\t\t\tmax=\"30\"\r\n\t\t\t\t\t(change)=\"onYearChanged($event)\" />\r\n\t\t\t\t<span class=\"floating-label year-fl\">Год</span>\r\n\t\t\t</div>\r\n\t\t\t<!-- <span *ngIf=\"expDateTouched && !isValidExpDate\">Ошибки: {{expError}}</span> -->\r\n\r\n\t\t\t<ng-template #expDateTooltipTemplate>\r\n\t\t\t\t<div>\r\n\t\t\t\t\tВведите дату как на карте\r\n\t\t\t\t</div>\r\n\t\t\t</ng-template>\r\n\r\n\t\t</div>\r\n\r\n\t\t<div class=\"form-line\">\r\n\t\t\t<input\r\n\t\t\t\tappTooltip\r\n\t\t\t\t[tooltipTemplateRef]=\"nameTooltipTemplate\"\r\n\t\t\t\t[showTooltip]=\"!creditCardSubGroup.controls.name.pristine && !creditCardSubGroup.value.name\"\r\n\t\t\t\tplacement=\"right\"\r\n\t\t\t\ttype=\"text\"\r\n\t\t\t\tclass=\"app app-name\"\r\n\t\t\t\tformControlName=\"name\">\r\n\t\t\t<span class=\"floating-label\">Владелец карты</span>\r\n\t\t</div>\r\n\t\t<ng-template #nameTooltipTemplate>\r\n\t\t\t<div>\r\n\t\t\t\tВведите имя владельца карты\r\n\t\t\t</div>\r\n\t\t</ng-template>\r\n\t</div>\r\n\r\n\t<div class=\"cvv-block-wrap\">\r\n\r\n\t\t<div class=\"magnet-strip\"></div>\r\n\r\n\t\t<div class=\"cvv-wrap\">\r\n\t\t\t<div class=\"stripes-wrap\">\r\n\t\t\t\t<div class=\"stripe\"></div>\r\n\t\t\t\t<div class=\"stripe\"></div>\r\n\t\t\t\t<div class=\"stripe\"></div>\r\n\t\t\t\t<div class=\"stripe\"></div>\r\n\t\t\t</div>\r\n\r\n\t\t\t<!-- [class]=\"cvvClass\" -->\r\n\t\t\t<input\r\n\t\t\t\tappTooltip\r\n\t\t\t\t[tooltipTemplateRef]=\"cvvTooltipTemplate\"\r\n\t\t\t\t[showTooltip]=\"cvvTouched && !isValidCVV\"\r\n\t\t\t\tplacement=\"right\"\r\n\t\t\t\tclass=\"app app-cvv\"\r\n\t\t\t\tappDigitOnly\r\n\t\t\t\tid=\"cvv\"\r\n\t\t\t\ttype=\"text\"\r\n\t\t\t\tformControlName=\"cvv\"\r\n\t\t\t\tmaxlength=\"3\"\r\n\t\t\t\tinputmode=\"numeric\"\r\n\t\t\t\tpattern=\"[0-9]*\"\r\n\t\t\t\t(input)=\"onCVVChanged($event)\" />\r\n\t\t\t<span class=\"floating-label\">CVV/CVC</span>\r\n\t\t</div>\r\n\t\t<ng-template #cvvTooltipTemplate>\r\n\t\t\t<div>\r\n\t\t\t\tНекорректный код\r\n\t\t\t</div>\r\n\t\t</ng-template>\r\n\r\n\t\t<div class=\"cvv-underline\">Три цифры <br/>на обороте карты</div>\r\n\r\n\t</div>\r\n\r\n</div>\r\n\r\n\r\n<!-- <br>\r\nDebug info:\r\n<br>\r\n<span *ngIf=\"cvvTouched && !isValidCVV\">Ошибки: {{cvvError}}</span>\r\n\r\n<br>\r\n<br>\r\nForm valid: {{creditCardSubGroup.valid}}\r\nComponent valid: {{valid}}\r\n -->\r\n","import { Directive, ElementRef, HostListener, Input, OnChanges, SimpleChanges } from \"@angular/core\";\r\n\r\n@Directive({\r\n\tselector: \"[appDigitOnly]\"\r\n})\r\nexport class DigitOnlyDirective implements OnChanges {\r\n\r\n\tprivate navigationKeys = [\r\n\t\t\"Backspace\",\r\n\t\t\"Delete\",\r\n\t\t\"Tab\",\r\n\t\t\"Escape\",\r\n\t\t\"Enter\",\r\n\t\t\"Home\",\r\n\t\t\"End\",\r\n\t\t\"ArrowLeft\",\r\n\t\t\"ArrowRight\",\r\n\t\t\"Clear\",\r\n\t\t\"Copy\",\r\n\t\t\"Paste\",\r\n\t];\r\n\r\n\t@Input() public min = -Infinity;\r\n\t@Input() public max = Infinity;\r\n\t@Input() public pattern?: string | RegExp;\r\n\tprivate regex: RegExp;\r\n\tpublic inputElement: HTMLInputElement;\r\n\r\n\tpublic constructor(private el: ElementRef) {\r\n\t\tthis.inputElement = el.nativeElement;\r\n\t}\r\n\r\n\tpublic ngOnChanges(changes: SimpleChanges) {\r\n\t\tif (changes.pattern) {\r\n\t\t\tthis.regex = this.pattern ? RegExp(this.pattern) : null;\r\n\t\t}\r\n\r\n\t\tif (changes.min) {\r\n\t\t\tconst maybeMin = Number(this.min);\r\n\t\t\tthis.min = isNaN(maybeMin) ? -Infinity : maybeMin;\r\n\t\t}\r\n\r\n\t\tif (changes.max) {\r\n\t\t\tconst maybeMax = Number(this.max);\r\n\t\t\tthis.max = isNaN(maybeMax) ? Infinity : maybeMax;\r\n\t\t}\r\n\t}\r\n\r\n\r\n\t@HostListener(\"keydown\", [\"$event\"])\r\n\tpublic onKeyDown(e: KeyboardEvent) {\r\n\r\n\t\tif (\r\n\t\t\tthis.navigationKeys.indexOf(e.key) > -1 || // Allow: navigation keys: backspace, delete, arrows etc.\r\n\t\t\t(e.key === \"a\" && e.ctrlKey === true) || // Allow: Ctrl+A\r\n\t\t\t(e.key === \"c\" && e.ctrlKey === true) || // Allow: Ctrl+C\r\n\t\t\t(e.key === \"v\" && e.ctrlKey === true) || // Allow: Ctrl+V\r\n\t\t\t(e.key === \"x\" && e.ctrlKey === true) || // Allow: Ctrl+X\r\n\t\t\t(e.key === \"a\" && e.metaKey === true) || // Allow: Cmd+A (Mac)\r\n\t\t\t(e.key === \"c\" && e.metaKey === true) || // Allow: Cmd+C (Mac)\r\n\t\t\t(e.key === \"v\" && e.metaKey === true) || // Allow: Cmd+V (Mac)\r\n\t\t\t(e.key === \"x\" && e.metaKey === true)  // Allow: Cmd+X (Mac)\r\n\t\t\t// || (this.decimal && e.key === this.decimalSeparator && !this.hasDecimalPoint) // Allow: only one decimal point\r\n\t\t) {\r\n\t\t\t// let it happen, don't do anything\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// Ensure that it is a number and stop the keypress\r\n\t\tif (e.key === \" \" || isNaN(Number(e.key))) {\r\n\t\t\te.preventDefault();\r\n\t\t}\r\n\r\n\t\t// check the input pattern RegExp\r\n\t\tif (this.regex) {\r\n\t\t\tconst newForecastValue = this.forecastValue(e.key);\r\n\t\t\tif (!this.regex.test(newForecastValue)) {\r\n\t\t\t\te.preventDefault();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tconst newValue = Number(this.forecastValue(e.key));\r\n\r\n\t\tif (newValue > this.max || newValue < this.min) {\r\n\t\t\te.preventDefault();\r\n\t\t}\r\n\t}\r\n\r\n\tprivate forecastValue(key: string): string {\r\n\t\tconst selectionStart = this.inputElement.selectionStart;\r\n\t\tconst selectionEnd = this.inputElement.selectionEnd;\r\n\t\tconst oldValue = this.inputElement.value;\r\n\t\tconst selection = oldValue.substring(selectionStart, selectionEnd);\r\n\t\treturn selection\r\n\t\t\t? oldValue.replace(selection, key)\r\n\t\t\t: oldValue.substring(0, selectionStart) +\r\n\t\t\tkey +\r\n\t\t\toldValue.substring(selectionStart);\r\n\t}\r\n}\r\n","import { FormControl, FormGroup } from \"@angular/forms\";\r\n\r\nexport enum CreditCardTypes {\r\n\tMASTERCARD = \"mastercard\",\r\n\tVISA = \"visa\",\r\n\tUNKNOWN = \"unknown\",\r\n}\r\n\r\nexport enum CREDIT_CARD_ERRORS {\r\n\tINVALID_LENGTH = \"invalid_length\",\r\n\tUNSUPPORTED_CARD = \"unsupported card\",\r\n\tINVALID_NUMBER = \"invalid_number\",\r\n\tINVALID_DATE = \"invalid_date\",\r\n\tINVALID_CCV = \"invalid_ccv\",\r\n\tNONE = \"none\",\r\n}\r\n\r\nexport enum CreditCardGroupComponents {\r\n\tCREDIT_CARD_NUMBER = \"creditCardNumber\",\r\n\tEXPIRATION_MONTH = \"expirationMonth\",\r\n\tEXPIRATION_YEAR = \"expirationYear\",\r\n\tNAME = \"name\",\r\n\tCVV = \"cvv\",\r\n}\r\n\r\nexport interface CreditCardGroup {\r\n\tccSubGroup: FormGroup;\r\n\tccNumber: FormControl;\r\n\texpirationMonth: FormControl;\r\n\texpirationYear: FormControl;\r\n\tcvv: FormControl;\r\n}\r\n\r\n\r\nexport interface CreditCardData {\r\n\tname: string;\r\n\tlength: number;\r\n\tminLength?: number;\r\n\tmaxLength?: number;\r\n\tcvvDigits: number;\r\n\timage: string;\r\n\tpattern: RegExp | null;\r\n}\r\n\r\nexport const creditCards: Record<CreditCardTypes, CreditCardData> = {\r\n\tmastercard: {\r\n\t\tname: \"Master Card\",\r\n\t\tlength: 16,\r\n\t\timage: \"/assets/images/ms_mini.png\",\r\n\t\tcvvDigits: 3,\r\n\t\tpattern: /^5[1-5]/\r\n\t},\r\n\tvisa: {\r\n\t\tname: \"Visa\",\r\n\t\tlength: 16,\r\n\t\timage: \"/assets/images/visa_mini.png\",\r\n\t\tcvvDigits: 3,\r\n\t\tpattern: /^4/,\r\n\t},\r\n\tunknown: {\r\n\t\tname: \"\",\r\n\t\tlength: 0,\r\n\t\timage: \"/assets/cc-image/unknown.png\",\r\n\t\tcvvDigits: 0,\r\n\t\tpattern: null,\r\n\t}\r\n};\r\n\r\nexport interface MonthValues {\r\n\tname: string;\r\n\tvalue: string;\r\n}\r\n\r\nexport const months: Array<MonthValues> = [\r\n\t{\r\n\t\tname: \"Jan-1\",\r\n\t\tvalue: \"1\",\r\n\t},\r\n\t{\r\n\t\tname: \"Feb-2\",\r\n\t\tvalue: \"2\",\r\n\t},\r\n\t{\r\n\t\tname: \"Mar-3\",\r\n\t\tvalue: \"3\",\r\n\t},\r\n\t{\r\n\t\tname: \"Apr-4\",\r\n\t\tvalue: \"4\",\r\n\t},\r\n\t{\r\n\t\tname: \"May-5\",\r\n\t\tvalue: \"5\",\r\n\t},\r\n\t{\r\n\t\tname: \"Jun-6\",\r\n\t\tvalue: \"6\",\r\n\t},\r\n\t{\r\n\t\tname: \"Jul-7\",\r\n\t\tvalue: \"7\",\r\n\t},\r\n\t{\r\n\t\tname: \"Aug-8\",\r\n\t\tvalue: \"8\",\r\n\t},\r\n\t{\r\n\t\tname: \"Sep-9\",\r\n\t\tvalue: \"9\",\r\n\t},\r\n\t{\r\n\t\tname: \"Oct-10\",\r\n\t\tvalue: \"10\",\r\n\t},\r\n\t{\r\n\t\tname: \"Nov-11\",\r\n\t\tvalue: \"11\",\r\n\t},\r\n\t{\r\n\t\tname: \"Dec-12\",\r\n\t\tvalue: \"12\",\r\n\t}\r\n];\r\n\r\nexport const years: Array<string> = [\"2020\", \"2021\", \"2022\", \"2023\", \"2024\"];\r\n","import { CreditCardData, creditCards, CreditCardTypes } from \"./domain\";\r\n\r\nexport const inEnum = (value: string, enumeration: object): boolean => {\r\n\r\n\tif (value === undefined || value == null || value === \"\") {\r\n\t\treturn false;\r\n\t}\r\n\r\n\tconst keys: Array<string> = Object.keys(enumeration);\r\n\tconst n: number = keys.length;\r\n\r\n\tlet i: number;\r\n\tfor (i = 0; i < n; ++i) {\r\n\t\tif (value === enumeration[keys[i]]) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\r\n\treturn false;\r\n};\r\n\r\nexport const getCardType = (cardNumber: string): CreditCardTypes => {\r\n\t// remove spaces/dashes from card number\r\n\tconst creditCardNumber: string = cardNumber.replace(/[ -]/g, \"\");\r\n\r\n\t// loop over types and test each pattern\r\n\tconst types: Array<string> = Object.values(CreditCardTypes);\r\n\tfor (const creditCardType of types) {\r\n\t\t// const type = creditCardType as CreditCardTypes;\r\n\t\tconst data = creditCards[creditCardType];\r\n\t\tconst pattern = data.pattern;\r\n\t\tif (pattern !== null && creditCardNumber.match(pattern)) {\r\n\t\t\treturn creditCardType as CreditCardTypes;\r\n\t\t}\r\n\t}\r\n\r\n\treturn CreditCardTypes.UNKNOWN;\r\n};\r\n\r\nexport const isCCLengthValid = (cardNumber: string, cardTypeIdentifier: string): boolean => {\r\n\tif (!inEnum(cardTypeIdentifier, CreditCardTypes)) {\r\n\t\treturn false;\r\n\t}\r\n\r\n\tconst data: Partial<CreditCardData> = creditCards[cardTypeIdentifier];\r\n\tconst digits: number = cardNumber.replace(/ /g, \"\").length;\r\n\r\n\tif (data.minLength !== undefined && data.maxLength !== undefined) {\r\n\t\treturn digits >= data.minLength && digits <= data.maxLength;\r\n\t}\r\n\r\n\treturn digits === data.length;\r\n};\r\n\r\nexport const isValidLuhn = (cardNumber: string): boolean => {\r\n\t// Classic Luhn validation\r\n\tconst ccNumbers: Array<number> = cardNumber.split(\"\").reverse().map((val: string): number => +val);\r\n\tconst len: number = ccNumbers.length;\r\n\r\n\tlet n = 0;\r\n\tlet sum = 0;\r\n\tlet j = 0;\r\n\r\n\tlet digit: number;\r\n\twhile (j < len) {\r\n\t\tdigit = ccNumbers[n];\r\n\t\tdigit = +digit;\r\n\r\n\t\tif (n % 2) {\r\n\t\t\tdigit *= 2;\r\n\r\n\t\t\tsum += (digit < 10) ? digit : digit - 9;\r\n\t\t} else {\r\n\t\t\tsum += digit;\r\n\t\t}\r\n\r\n\t\tn = ++j;\r\n\t}\r\n\r\n\treturn sum % 10 === 0;\r\n};\r\n","import { Pipe, PipeTransform } from \"@angular/core\";\r\n\r\n@Pipe({\r\n\tname: \"time\"\r\n})\r\nexport class TimePipe implements PipeTransform {\r\n\r\n\tpublic transform(value: number, args?: any): any {\r\n\t\treturn `${Math.floor(value / 60)}:${(\"0\" + (value % 60)).slice(-2)}`;\r\n\t}\r\n\r\n}\r\n","import {\r\n\tDirective, ElementRef, HostListener, Input, OnChanges,\r\n\tRenderer2, SimpleChanges, TemplateRef, ViewContainerRef\r\n} from \"@angular/core\";\r\n\r\n@Directive({\r\n\tselector: \"[appTooltip]\"\r\n})\r\nexport class TooltipDirective implements OnChanges {\r\n\r\n\t@Input() public tooltipTitle: string;\r\n\t@Input() public placement: string;\r\n\t@Input() public delay: string;\r\n\t@Input() public tooltipTemplateRef: TemplateRef<any>;\r\n\t@Input() public showTooltip: string;\r\n\r\n\tprivate tooltip: HTMLElement;\r\n\tprivate offset = 10;\r\n\r\n\tpublic constructor(\r\n\t\tprivate el: ElementRef,\r\n\t\tprivate renderer: Renderer2,\r\n\t\tprivate readonly vcr: ViewContainerRef\r\n\t) { }\r\n\r\n\tpublic ngOnChanges(changes: SimpleChanges) {\r\n\t\tif (changes.showTooltip) {\r\n\t\t\tif (this.showTooltip && this.needed() && !this.tooltip) {\r\n\t\t\t\tthis.show();\r\n\t\t\t} else if (this.tooltip) {\r\n\t\t\t\tthis.hide();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t@HostListener(\"mouseenter\")\r\n\tpublic onMouseEnter() {\r\n\t\t// if (this.needed() && !this.tooltip) {\r\n\t\t// \tthis.show();\r\n\t\t// }\r\n\t}\r\n\r\n\t@HostListener(\"mouseleave\")\r\n\tpublic onMouseLeave() {\r\n\t\t// if (!this.showTooltip && this.tooltip) {\r\n\t\t// \tthis.hide();\r\n\t\t// }\r\n\t}\r\n\r\n\tprivate show() {\r\n\t\tthis.create();\r\n\t\tthis.setPosition();\r\n\t\tthis.renderer.addClass(this.tooltip, \"ng-tooltip-show\");\r\n\t}\r\n\r\n\tprivate hide() {\r\n\t\tthis.renderer.removeClass(this.tooltip, \"ng-tooltip-show\");\r\n\t\twindow.setTimeout(() => {\r\n\t\t\tthis.renderer.removeChild(document.body, this.tooltip);\r\n\t\t\tthis.tooltip = null;\r\n\t\t}, +this.delay);\r\n\t}\r\n\r\n\tprivate create() {\r\n\t\tthis.tooltip = this.renderer.createElement(\"div\");\r\n\t\tconst child = this.tooltipTemplateRef\r\n\t\t\t? this.vcr.createEmbeddedView(this.tooltipTemplateRef).rootNodes[0]\r\n\t\t\t: this.renderer.createText(this.tooltipTitle);\r\n\t\tthis.renderer.appendChild(this.tooltip, child);\r\n\t\tthis.renderer.appendChild(document.body, this.tooltip);\r\n\t\tthis.renderer.addClass(this.tooltip, \"ng-tooltip\");\r\n\t\tthis.renderer.addClass(this.tooltip, `ng-tooltip-${this.placement}`);\r\n\t\tthis.renderer.setStyle(this.tooltip, \"-webkit-transition\", `opacity ${this.delay}ms`);\r\n\t\tthis.renderer.setStyle(this.tooltip, \"-moz-transition\", `opacity ${this.delay}ms`);\r\n\t\tthis.renderer.setStyle(this.tooltip, \"-o-transition\", `opacity ${this.delay}ms`);\r\n\t\tthis.renderer.setStyle(this.tooltip, \"transition\", `opacity ${this.delay}ms`);\r\n\t}\r\n\r\n\tprivate setPosition() {\r\n\t\tconst hostPos = this.el.nativeElement.getBoundingClientRect();\r\n\t\tconst tooltipPos = this.tooltip.getBoundingClientRect();\r\n\t\tconst scrollPos = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop || 0;\r\n\r\n\t\tlet top: any;\r\n\t\tlet left: any;\r\n\r\n\t\tif (this.placement === \"top\") {\r\n\t\t\ttop = hostPos.top - tooltipPos.height - this.offset;\r\n\t\t\tleft = hostPos.left + (hostPos.width - tooltipPos.width) / 2;\r\n\t\t}\r\n\r\n\t\tif (this.placement === \"bottom\") {\r\n\t\t\ttop = hostPos.bottom + this.offset;\r\n\t\t\tleft = hostPos.left + (hostPos.width - tooltipPos.width) / 2;\r\n\t\t}\r\n\r\n\t\tif (this.placement === \"left\") {\r\n\t\t\ttop = hostPos.top + (hostPos.height - tooltipPos.height) / 2;\r\n\t\t\tleft = hostPos.left - tooltipPos.width - this.offset;\r\n\t\t}\r\n\r\n\t\tif (this.placement === \"right\") {\r\n\t\t\ttop = hostPos.top + (hostPos.height - tooltipPos.height) / 2;\r\n\t\t\tleft = hostPos.right + this.offset;\r\n\t\t}\r\n\r\n\t\tthis.renderer.setStyle(this.tooltip, \"top\", `${top + scrollPos}px`);\r\n\t\tthis.renderer.setStyle(this.tooltip, \"left\", `${left}px`);\r\n\t}\r\n\r\n\tprivate needed() {\r\n\t\treturn this.tooltipTemplateRef || this.tooltipTitle;\r\n\t}\r\n}\r\n","// This file can be replaced during build by using the `fileReplacements` array.\r\n// `ng build --prod` replaces `environment.ts` with `environment.prod.ts`.\r\n// The list of file replacements can be found in `angular.json`.\r\n\r\nexport const environment = {\r\n  production: false\r\n};\r\n\r\n/*\r\n * For easier debugging in development mode, you can import the following file\r\n * to ignore zone related error stack frames such as `zone.run`, `zoneDelegate.invokeTask`.\r\n *\r\n * This import should be commented out in production mode because it will have a negative impact\r\n * on performance if an error is thrown.\r\n */\r\n// import 'zone.js/dist/zone-error';  // Included with Angular CLI.\r\n","import { enableProdMode } from '@angular/core';\r\nimport { platformBrowserDynamic } from '@angular/platform-browser-dynamic';\r\n\r\nimport { AppModule } from './app/app.module';\r\nimport { environment } from './environments/environment';\r\n\r\nif (environment.production) {\r\n  enableProdMode();\r\n}\r\n\r\nplatformBrowserDynamic().bootstrapModule(AppModule)\r\n  .catch(err => console.error(err));\r\n"]}